exports.id=1431,exports.ids=[1431],exports.modules={15256:(e,t,a)=>{"use strict";a.d(t,{Tk:()=>s,Ue:()=>o,Ym:()=>i,p9:()=>r,tj:()=>d});var n=a(85668),l=a.n(n);let i=e=>e?"string"==typeof e?e:e.format?e.format("YYYY-MM-DD"):e.$d?l()(e.$d).format("YYYY-MM-DD"):e instanceof Date?l()(e).format("YYYY-MM-DD"):null:null,s=e=>e?"string"==typeof e?e:e.format?e.format("HH:mm:ss"):e.$d?l()(e.$d).format("HH:mm:ss"):e instanceof Date?l()(e).format("HH:mm:ss"):null:null,r=e=>e?l()(e):null,o=e=>e?l()(e,"HH:mm:ss"):null,d=(e,t)=>{if(!e)return new Date().toISOString();let a=l()(e);if(t){let e=l()(t,"HH:mm:ss");return a.hour(e.hour()).minute(e.minute()).second(e.second()).toISOString()}return a.toISOString()}},20309:(e,t,a)=>{"use strict";a.d(t,{A:()=>h});var n=a(60687),l=a(43210),i=a(34280),s=a(74018),r=a(77833),o=a(10678),d=a(52935),c=a(55111),u=a(47533);let m={width:"100%",height:"500px"};function h({centerCoords:e,markerState:t,setMarkerState:a,placeName:i,setPlaceName:d}){let[m,h]=(0,l.useState)(e),[g,x]=(0,l.useState)(!1),[y,j]=(0,l.useState)(!1),v=(0,l.useMemo)(()=>e||{lat:27.63820799904629,lng:85.51344372504178},[e]),[f,A]=(0,l.useState)(v),b=async()=>{j(!0);try{await new Promise((e,n)=>{if(!navigator.geolocation){n(Error("Geolocation not supported"));return}navigator.geolocation.getCurrentPosition(n=>{let l={lat:n.coords.latitude,lng:n.coords.longitude};A(l),h(l),t.lat===v.lat&&t.lng===v.lng&&a(l),s.Ay.success("Location detected successfully"),e(n)},n,{enableHighAccuracy:!1,timeout:1e4,maximumAge:6e5})})}catch(e){try{let e=await fetch("https://ipapi.co/json/"),n=await e.json();if(n.latitude&&n.longitude){let e={lat:n.latitude,lng:n.longitude};A(e),h(e),t.lat===v.lat&&t.lng===v.lng&&a(e)}else throw Error("IP location failed")}catch(e){s.Ay.warning("Could not detect location. Using default location (Kathmandu)."),A(v),h(v),t.lat===v.lat&&(t.lng,v.lng)}}finally{j(!1)}},_=()=>{x(!1)},w=()=>{x(!1),a(f)},C=async(e,t)=>{new window.google.maps.Geocoder().geocode({location:{lat:e,lng:t}},(e,t)=>{"OK"===t?e[0]?d(e[0].formatted_address):d("No results found"):d("Geocoder failed due to: "+t)})},{isLoaded:k}=(0,u._)();return k?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Ay,{onClick:()=>{x(!0)},type:"link",icon:(0,n.jsx)(c.A,{}),size:"small",block:!1,style:{width:"max-content"},loading:y,children:y?"Getting Location...":"Open Map"}),(0,n.jsxs)(o.A,{title:"Map",open:g,onOk:_,onCancel:w,style:{top:20},width:800,footer:[(0,n.jsx)(r.Ay,{onClick:w,children:"Cancel"},"cancel"),(0,n.jsx)(r.Ay,{onClick:b,loading:y,children:"Retry Location"},"retry"),(0,n.jsx)(r.Ay,{type:"primary",onClick:_,children:"OK"},"ok")],children:[(0,n.jsx)(p,{markerState:t,setMarkerState:a,center:m,setCenterState:h,setPlaceName:d,geocodeLatLng:C}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Selected Place:"})," ",i]})]})]}):(0,n.jsx)("div",{children:"Map Loading...."})}function p({markerState:e,setMarkerState:t,center:a,setCenterState:s,setPlaceName:r,geocodeLatLng:o}){let c=(0,l.useRef)(null);return(0,n.jsxs)(i.u6,{zoom:18,mapContainerStyle:m,center:a,onClick:e=>{let a=e.latLng.lat(),n=e.latLng.lng();t({lat:a,lng:n}),o(a,n)},children:[(0,n.jsx)(i.dj,{onLoad:e=>c.current=e,onPlacesChanged:()=>{let e=c.current.getPlaces();if(0===e.length)return;let a=e[0],n=a.geometry.location;t({lat:n.lat(),lng:n.lng()}),s({lat:n.lat(),lng:n.lng()}),r(a.formatted_address+" "+a.name)},children:(0,n.jsx)(d.A,{type:"text",placeholder:"Search location",style:{boxSizing:"border-box",border:"1px solid transparent",width:"240px",height:"32px",padding:"0 12px",borderRadius:"3px",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.3)",fontSize:"14px",outline:"none",textOverflow:"ellipses",position:"absolute",left:"50%",marginLeft:"-120px",top:"10px",zIndex:"10"}})}),(0,n.jsx)(i.X0,{position:e,onDragEnd:e=>{let a=e.latLng?.lat()||0,n=e.latLng?.lng()||0;t({lat:a,lng:n}),o(a,n)},draggable:!0})]})}},33871:(e,t,a)=>{"use strict";a.d(t,{h:()=>s});var n=a(85665),l=a(15256);let i={lat:27.63820799904629,lng:85.51344372504178},s=(0,n.vt)((e,t)=>({current:0,youtubeLink:null,cohosts:[],invitees:[],mediaType:"image",markerState:i,placeName:"",formData:{},userLocation:null,setCurrent:t=>e({current:t}),setYoutubeLink:t=>e({youtubeLink:t}),setCohosts:t=>e({cohosts:t}),setInvitees:t=>e({invitees:t}),setMediaType:t=>e({mediaType:t}),setMarkerState:t=>e({markerState:t}),setPlaceName:t=>e({placeName:t}),setFormData:t=>e({formData:t}),updateFormField:(a,n)=>{let i=t().formData;("event_date"===a||"event_date_to"===a)&&(n=(0,l.Ym)(n)),("event_start_time"===a||"event_end_time"===a)&&(n=(0,l.Tk)(n)),e({formData:{...i,[a]:n}})},setUserLocation:a=>{e({userLocation:a});let n=t();a&&n.markerState.lat===i.lat&&n.markerState.lng===i.lng&&e({markerState:a})},uploadedImage:void 0,imageSize:{width:0,height:0},template:void 0,fullData:void 0,eventResources:new FormData,templateData:void 0,setTemplateData:t=>e({templateData:t}),setEventResources:t=>e({eventResources:t}),setFullData:t=>e({fullData:t}),setImageSize:t=>e({imageSize:t}),setTemplate:t=>e({template:t}),setUploadedImage:t=>e({uploadedImage:t}),reset:()=>e({current:0,youtubeLink:null,cohosts:[],invitees:[],mediaType:"image",markerState:t().userLocation||i,placeName:"",formData:{},uploadedImage:void 0,template:void 0,imageSize:{width:0,height:0},templateData:void 0,fullData:void 0,eventResources:new FormData})}))},33983:(e,t,a)=>{"use strict";a.d(t,{A:()=>ei});var n=a(60687),l=a(43210),i=a(44581),s=a(33871),r=a(15256),o=a(20309),d=a(17936);let c=a(86552),u=e=>e?new c(new Date(e)).format("YYYY-MM-DD"):null;var m=a(85975),h=a(54314),p=a(5146),g=a(81945),x=a(23587),y=a(2741),j=a(71103),v=a(34308),f=a(36293),A=a(29494),b=a(52935),_=a(86072),w=a(67501),C=a(77833),k=a(96625),S=a(4691),I=a(42585),E=a(9921),T=a(36638),F=a(5711),D=a(59823),L=a(29220),P=a(78756),U=a(72125),N=a(30036);a(21165);var R=a(79249),B=a(64054),z=a(74018),M=a(10678),V=a(69587),O=a(43313);let Y=async()=>{try{return await O.y1.get("csvs/")}catch(e){throw console.error("Error fetching CSV data:",e),Error(e)}};async function $(e){try{let t=await O.y1.post("csvs/",e,{headers:{"Content-Type":"application/json"}});return console.log("CSV post response:",t),t}catch(e){throw console.error("Error posting CSV data:",e),Error(e.message||"Failed to upload CSV")}}var H=a(717);let{Dragger:q}=B.A,G=({form:e,selectedCsvIds:t,setSelectedCsvIds:a})=>{let[i,s]=(0,l.useState)([]),[r,o]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),{uploadFileDirect:u}=(0,H.Z)(),m=t=>{a(e=>e.includes(t.id)?e.filter(e=>e!==t.id):[...e,t.id]);let n=e.getFieldValue("csv_ids")||[];n.includes(t.id)?e.setFieldValue("csv_ids",n.filter(e=>e!==t.id)):e.setFieldValue("csv_ids",[...n,t.id])},h=async t=>{c(!0);let n=z.Ay.loading("Uploading file...",0);try{let n=await u(t,{purpose:"csv_import",description:`CSV file for guest list: ${t.name}`,folder:"csv-files"});if("success"!==n.status)throw Error("Upload failed");let l={name:t.name,file_id:n.fileId,guest_count:0},i=await $(l);if(i?.id){let t=e.getFieldValue("csv_ids")||[];t.includes(i.id)||(e.setFieldValue("csv_ids",[...t,i.id]),a(e=>[...e,i.id]))}z.Ay.success(`${t.name} uploaded successfully`);let r=await Y();return s(r),!0}catch(e){return z.Ay.error(`Upload failed: ${e.message||"Unknown error"}`),!1}finally{n(),c(!1)}};return(0,l.useEffect)(()=>{r&&Y().then(e=>s(e)).catch(e=>{console.error("Error fetching CSV data:",e),z.Ay.error("Failed to load CSV files")})},[r]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.Ay,{style:{width:"50%"},onClick:()=>o(!0),loading:d,children:"Upload CSV file"}),(0,n.jsxs)(M.A,{title:"CSV Files",open:r,onCancel:()=>o(!1),footer:[(0,n.jsx)(C.Ay,{type:"primary",onClick:()=>o(!1),children:"Done"},"done")],width:600,children:[(0,n.jsxs)(q,{accept:".csv",name:"file",multiple:!0,fileList:[],beforeUpload:async e=>(await h(e),!1),customRequest:({onSuccess:e})=>{setTimeout(()=>e("ok",null),0)},disabled:d,children:[(0,n.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload CSV"}),d&&(0,n.jsx)("p",{children:"Uploading..."})]}),(0,n.jsx)("br",{}),(0,n.jsx)("label",{style:{fontWeight:"600"},children:"Your CSV Files"}),(0,n.jsx)("p",{style:{fontSize:"12px",color:"#666"},children:"Click to select multiple files"}),(0,n.jsx)("br",{}),(0,n.jsx)("div",{style:{width:"100%",overflowX:"auto",maxHeight:"300px",overflowY:"auto"},children:i&&i.length>0?(0,n.jsx)("div",{className:"csv-list",children:i.map(e=>(0,n.jsxs)("div",{className:`csv-item ${t.includes(e.id)?"selected":""}`,onClick:()=>m(e),style:{padding:"10px 12px",margin:"6px 0",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",borderRadius:"6px",border:t.includes(e.id)?"1px solid #1890ff":"1px solid #f0f0f0",backgroundColor:t.includes(e.id)?"#e6f7ff":"transparent",transition:"all 0.2s"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(V.EHs,{color:"gray"}),"\xa0\xa0",e.name]}),t.includes(e.id)&&(0,n.jsx)(V.CMH,{color:"#1890ff"})]},e.id))}):(0,n.jsx)("p",{children:"No CSV files found. Upload one to see it here."})})]}),e.getFieldValue("csv_ids")?.length>0&&(0,n.jsxs)("div",{style:{marginTop:"8px"},children:[(0,n.jsx)("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Selected CSV Files:"}),(0,n.jsx)("div",{style:{marginTop:"8px",width:"100%"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",backgroundColor:"#e6f7ff",padding:"6px 12px",borderRadius:"4px",border:"1px solid #91d5ff"},children:[(0,n.jsx)(V.EHs,{size:14,color:"#1890ff",style:{marginRight:"8px"}}),(0,n.jsxs)("span",{children:[e.getFieldValue("csv_ids")?.length||0," ",e.getFieldValue("csv_ids")?.length===1?"file":"files"," ","selected"]}),e.getFieldValue("csv_ids")?.length>0&&(0,n.jsx)(C.Ay,{size:"small",type:"text",danger:!0,style:{marginLeft:"auto"},onClick:()=>{a([]),e.setFieldValue("csv_ids",[])},children:"Clear all"})]})})]})]})};a(81293);var K=a(5948),W=a(74359),Z=a(79450),X=a(53082),J=a(23575);let Q=({visible:e,onCancel:t,type:a})=>{let{invitees:r,setInvitees:o,cohosts:d,setCohosts:c}=(0,s.h)(),[u]=i.A.useForm(),m="invitee"===a,h=m?r:d,p=m?o:c,[g,x]=(0,l.useState)([]);(0,l.useEffect)(()=>{e&&x(h||[])},[e,h]);let y=m?"invitee":"cohost",v=e=>{let t=[...g];t.splice(e,1),x(t)},f=()=>{u.resetFields(),x(h||[]),t()};return(0,n.jsxs)(M.A,{title:m?"Manage Invitees":"Manage Cohosts",open:e,onCancel:f,footer:[(0,n.jsx)(C.Ay,{onClick:f,children:"Cancel"},"cancel"),(0,n.jsx)(C.Ay,{type:"primary",onClick:()=>{u.validateFields().then(e=>{e.name&&e.phone_number?p([...g,{name:e.name,phone_number:e.phone_number}]):p(g),u.resetFields(),t()}).catch(()=>{p(g),t()})},children:m?"Save Invitees":"Save Cohosts"},"save")],width:600,children:[(0,n.jsxs)(_.A.Paragraph,{children:["Add ",m?"invitees":"co-hosts"," to your event. Each ",y," needs a name and phone number."]}),(0,n.jsxs)(i.A,{form:u,layout:"vertical",name:`${y}Form`,children:[(0,n.jsxs)(T.A,{style:{display:"flex",width:"100%"},size:"middle",children:[(0,n.jsx)(i.A.Item,{name:"name",label:"Name",rules:[{required:!0,message:`Please enter ${y} name`}],style:{flex:1},children:(0,n.jsx)(b.A,{placeholder:"Enter name",prefix:(0,n.jsx)(j.A,{})})}),(0,n.jsx)(i.A.Item,{name:"phone_number",label:"Phone Number",rules:[{required:!0,message:"Please enter phone number"},{pattern:/^[0-9+\-\s]+$/,message:"Please enter a valid phone number"}],style:{flex:1},children:(0,n.jsx)(b.A,{placeholder:"Enter phone number",prefix:(0,n.jsx)(Z.A,{})})})]}),(0,n.jsx)(i.A.Item,{children:(0,n.jsx)(C.Ay,{type:"dashed",onClick:()=>{u.validateFields().then(e=>{x([...g,{name:e.name,phone_number:e.phone_number}]),u.resetFields()}).catch(e=>{console.log("Validate Failed:",e)})},icon:(0,n.jsx)(X.A,{}),block:!0,children:m?"Add Invitee":"Add Cohost"})})]}),g.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(K.A,{orientation:"left",children:m?"Current Invitees":"Current Cohosts"}),(0,n.jsx)(W.A,{size:"small",bordered:!0,dataSource:g,renderItem:(e,t)=>(0,n.jsx)(W.A.Item,{actions:[(0,n.jsx)(C.Ay,{type:"text",danger:!0,icon:(0,n.jsx)(J.A,{}),onClick:()=>v(t)},"delete")],children:(0,n.jsx)(W.A.Item.Meta,{title:e.name,description:e.phone_number})})})]})]})},ee=(0,N.default)(async()=>{},{loadableGenerated:{modules:["app/[locale]/(dashboards)/user/create-event/_components/DetailsForm.tsx -> react-quill-new"]},ssr:!1}),{TextArea:et}=b.A,{Title:ea,Text:en}=_.A,el=({form:e})=>{let{setCurrent:t,cohosts:a,invitees:c,markerState:_,setMarkerState:N,placeName:B,setPlaceName:z,formData:M,updateFormField:V,userLocation:O}=(0,s.h)(),[Y,$]=(0,l.useState)(!0),[H,q]=(0,l.useState)([]),[K,W]=(0,l.useState)(!1),[Z,X]=(0,l.useState)(!1),[J,ea]=(0,l.useState)("contact"),[el,ei]=(0,l.useState)(!1),{data:es,isLoading:er}=(0,A.I)({queryKey:["groups"],queryFn:d.Wx});(0,l.useEffect)(()=>{if(M&&Object.keys(M).length>0){let t={...M};M.event_date&&(t.event_date=(0,r.p9)(M.event_date)),M.event_date_to&&(t.event_date_to=(0,r.p9)(M.event_date_to)),M.event_start_time&&(t.event_start_time=(0,r.Ue)(M.event_start_time)),M.event_end_time&&(t.event_end_time=(0,r.Ue)(M.event_end_time)),e.setFieldsValue(t),M.name_source&&ea(M.name_source),M.event_date_to&&ei(!0),M.csv_ids&&q(M.csv_ids)}},[e]);let eo=e=>t=>{V(e,t)},ed=t=>a=>{e.setFieldValue(t,a),V(t,a)};(0,l.useEffect)(()=>{if(Y){$(!1);return}B&&(e.setFieldValue("locName",B),V("locName",B))},[B,e]),(0,l.useEffect)(()=>{e.getFieldValue("csv_ids")||(e.setFieldValue("csv_ids",[]),V("csv_ids",[]))},[e]);let ec=t=>{ea(t),e.setFieldValue("name_source",t),V("name_source",t)},eu=()=>{let t=e.getFieldValue("group_ids")?.length>0,a=e.getFieldValue("csv_ids")?.length>0,n=c&&c.length>0;return t||a||n},em=t=>{ei(t),t||(e.setFieldValue("event_date_to",void 0),V("event_date_to",null))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w.A,{justify:"space-between",className:"mb-3",children:(0,n.jsx)(C.Ay,{onClick:()=>t(1),icon:(0,n.jsx)(m.A,{}),type:"link",children:"Go back"})}),(0,n.jsxs)(k.A,{justify:"center",gutter:[16,16],children:[(0,n.jsx)(S.A,{xs:24,lg:20,children:(0,n.jsxs)(I.A,{size:"small",title:(0,n.jsxs)(w.A,{align:"center",gap:8,children:[(0,n.jsx)(h.A,{}),(0,n.jsx)("span",{children:"Event Details"})]}),style:{boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:16},children:[(0,n.jsx)(i.A.Item,{name:"title",label:"Event Title",rules:[{required:!0,message:"Please enter event title"}],children:(0,n.jsx)(b.A,{placeholder:"Enter event title",onChange:e=>eo("title")(e.target.value)})}),(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)(en,{strong:!0,style:{fontSize:14,marginBottom:12,display:"block"},children:"Event Date & Time"}),(0,n.jsx)(i.A.Item,{name:"event_date",label:"Event Date",rules:[{required:!0,message:"Please select event date"}],style:{marginBottom:16},children:(0,n.jsx)(f.A,{hideDefaultValue:!M.event_date,defaultDate:u(M.event_date||""),language:"en",className:"w-full",style:{width:"100%"},placeholder:"Select event date",onChange:t=>{let a=t?.adDate||null;e.setFieldValue("event_date",a),V("event_date",a);let n=e.getFieldValue("event_date_to");n&&a&&new Date(a)>new Date(n)&&(e.setFieldValue("event_date_to",null),V("event_date_to",null))}})}),(0,n.jsxs)(k.A,{gutter:16,children:[(0,n.jsx)(S.A,{span:12,children:(0,n.jsx)(i.A.Item,{name:"event_start_time",label:"Start Time",rules:[{required:!0,message:"Please select start time"}],children:(0,n.jsx)(E.A,{showNow:!1,format:"HH:mm",style:{width:"100%"},placeholder:"Select start time",onChange:ed("event_start_time")})})}),(0,n.jsx)(S.A,{span:12,children:(0,n.jsx)(i.A.Item,{name:"event_end_time",label:"End Time",dependencies:["event_start_time"],rules:[({getFieldValue:e})=>({validator(t,a){let n=e("event_start_time");return a&&n&&a.isBefore(n)?Promise.reject("End time must be after start time"):Promise.resolve()}})],children:(0,n.jsx)(E.A,{format:"HH:mm",showNow:!1,style:{width:"100%"},placeholder:"Select end time (optional)",onChange:ed("event_end_time")})})})]}),(0,n.jsx)(T.A,{direction:"vertical",style:{width:"100%",marginBottom:16},children:(0,n.jsx)(F.A,{checked:el,onChange:e=>em(e.target.checked),children:(0,n.jsxs)(w.A,{align:"center",gap:4,children:[(0,n.jsx)(h.A,{}),(0,n.jsx)("span",{children:"Multi-day event"})]})})}),el&&(0,n.jsx)("div",{style:{backgroundColor:"#f8f9fa",padding:16,borderRadius:8,border:"1px solid #e9ecef"},children:(0,n.jsx)(i.A.Item,{name:"event_date_to",label:"End Date",dependencies:["event_date"],rules:[{required:el,message:"Please select end date"},({getFieldValue:e})=>({validator(t,a){let n=e("event_date");return a&&n&&new Date(a)<new Date(n)?Promise.reject("End date must be after start date"):Promise.resolve()}})],children:(0,n.jsx)(f.A,{hideDefaultValue:!0,defaultDate:u(M.event_date_to||""),language:"en",className:"w-full",style:{width:"100%"},placeholder:"Select end date",onChange:t=>{let a=t?.adDate||null;e.setFieldValue("event_date_to",a),V("event_date_to",a)}})})})]}),(0,n.jsxs)(k.A,{gutter:16,children:[(0,n.jsx)(S.A,{span:12,children:(0,n.jsx)(i.A.Item,{name:"venue",label:"Venue",rules:[{required:!1,message:"Please enter venue name"}],children:(0,n.jsx)(b.A,{placeholder:"Venue name (optional)",onChange:e=>eo("venue")(e.target.value)})})}),(0,n.jsxs)(S.A,{span:12,children:[(0,n.jsx)(i.A.Item,{name:"locName",label:"Location",style:{marginBottom:"5px"},rules:[{required:!0,message:"Please select a location"}],children:(0,n.jsx)(b.A,{disabled:!0,placeholder:"Select on map below"})}),(0,n.jsx)(o.A,{centerCoords:O||{lat:27.63820799904629,lng:85.51344372504178},markerState:_,setMarkerState:N,placeName:B,setPlaceName:z})]})]}),(0,n.jsx)(i.A.Item,{name:"is_public",label:"Event Visibility",valuePropName:"checked",children:(0,n.jsx)(D.A,{checkedChildren:"Public",unCheckedChildren:"Private",onChange:eo("is_public")})})]})}),(0,n.jsx)(S.A,{xs:24,lg:20,children:(0,n.jsxs)(I.A,{size:"small",title:(0,n.jsxs)(w.A,{align:"center",gap:8,children:[(0,n.jsx)(p.A,{}),(0,n.jsx)("span",{children:"Event Description"})]}),style:{boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:16},children:[(0,n.jsx)(i.A.Item,{name:"description",label:"Short Description",rules:[{required:!0,message:"Please enter a description"}],children:(0,n.jsx)(et,{rows:3,placeholder:"Enter a brief description of your event",maxLength:200,showCount:!0,onChange:e=>eo("description")(e.target.value)})}),(0,n.jsx)(i.A.Item,{name:"rich_description",label:"Rich Description",children:(0,n.jsx)(ee,{theme:"snow",placeholder:"Add formatted details about your event...",style:{height:150,marginBottom:50},onChange:eo("rich_description")})}),(0,n.jsx)(i.A.Item,{name:"sms",label:"SMS Notification Template",children:(0,n.jsx)(et,{rows:3,placeholder:"Custom SMS message for invitees",maxLength:160,showCount:!0,onChange:e=>eo("sms")(e.target.value)})})]})}),(0,n.jsx)(S.A,{xs:24,lg:20,children:(0,n.jsxs)(I.A,{size:"small",title:(0,n.jsxs)(w.A,{align:"center",gap:8,children:[(0,n.jsx)(g.A,{}),(0,n.jsx)("span",{children:"Hosts & Invitees"})]}),style:{boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[(0,n.jsx)(i.A.Item,{name:"host",label:"Event Host",rules:[{required:!0,message:"Host name is required"}],children:(0,n.jsx)(b.A,{placeholder:"Main host name",onChange:e=>eo("host")(e.target.value)})}),(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsxs)(w.A,{justify:"space-between",align:"center",children:[(0,n.jsx)(en,{strong:!0,children:"Cohosts"}),(0,n.jsx)(C.Ay,{type:"primary",icon:(0,n.jsx)(x.A,{}),onClick:()=>W(!0),children:"Manage Cohosts"})]}),a&&a.length>0?(0,n.jsx)("div",{style:{marginTop:8},children:a.map((e,t)=>(0,n.jsxs)("div",{style:{marginBottom:4,padding:8,background:"#f5f5f5",borderRadius:4},children:[(0,n.jsx)("strong",{children:e.name})," - ",e.phone_number]},t))}):(0,n.jsx)("div",{style:{color:"#999",fontStyle:"italic",marginTop:8},children:"No cohosts added yet"})]}),(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)(en,{strong:!0,style:{fontSize:16,marginBottom:16,display:"block"},children:"Invitee Sources"}),!eu()&&(0,n.jsx)(L.A,{message:"Please add at least one invitee source",description:"You must select groups, upload a CSV file, or manually add invitees to proceed.",type:"warning",showIcon:!0,style:{marginBottom:16}}),(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsxs)(w.A,{justify:"space-between",align:"center",style:{marginBottom:8},children:[(0,n.jsx)(en,{strong:!0,children:"Manual Invitees"}),(0,n.jsx)(C.Ay,{type:"primary",icon:(0,n.jsx)(y.A,{}),onClick:()=>X(!0),children:"Manage Invitees"})]}),c&&c.length>0?(0,n.jsxs)("div",{children:[(0,n.jsxs)(en,{type:"secondary",children:[c.length," invitees added manually"]}),(0,n.jsxs)("div",{style:{marginTop:8,maxHeight:120,overflowY:"auto"},children:[c.slice(0,3).map((e,t)=>(0,n.jsxs)("div",{style:{marginBottom:4,padding:6,background:"#e6f4ff",borderRadius:4,fontSize:12},children:[(0,n.jsx)("strong",{children:e.name})," -"," ",e.phone_number]},t)),c.length>3&&(0,n.jsxs)(en,{type:"secondary",style:{fontSize:12},children:["...and ",c.length-3," more"]})]})]}):(0,n.jsx)(en,{type:"secondary",style:{fontStyle:"italic"},children:"No manual invitees added yet"})]}),(0,n.jsx)(i.A.Item,{name:"csv_ids",label:"CSV of Invitees",valuePropName:"value",style:{width:"100%"},children:(0,n.jsx)(G,{form:e,selectedCsvIds:H,setSelectedCsvIds:q})}),(0,n.jsxs)(k.A,{justify:"space-between",align:"middle",children:[(0,n.jsx)(S.A,{span:18,children:(0,n.jsx)(i.A.Item,{name:"group_ids",label:"Select Groups",children:(0,n.jsx)(P.A,{mode:"multiple",placeholder:"Select groups to invite",loading:er,style:{width:"100%"},onChange:eo("group_ids"),children:es?.map(e=>n.jsxs(P.A.Option,{value:e.id,children:[e.name," (",e.contacts_count," contacts)"]},e.id))})})}),(0,n.jsx)(S.A,{children:(0,n.jsx)(R.default,{hastitle:!1})})]})]}),(0,n.jsx)(i.A.Item,{name:"invitee_validation",rules:[{validator:()=>eu()?Promise.resolve():Promise.reject("Please select at least one invitee source (groups, CSV, or manual invitees)")}],style:{marginBottom:0},children:(0,n.jsx)(b.A,{type:"hidden"})}),(0,n.jsxs)("div",{style:{marginTop:16},children:[(0,n.jsx)(i.A.Item,{name:"name_source",label:"Name Source for Invitations",rules:[{required:!0,message:"Please select a name source"}],children:(0,n.jsx)(U.A,{block:!0,value:J,onChange:e=>ec(e),options:[{label:(0,n.jsxs)("div",{style:{padding:"4px 0"},children:[(0,n.jsx)(j.A,{style:{fontSize:"16px"}}),(0,n.jsx)("div",{children:"Use Contact Names"})]}),value:"contact"},{label:(0,n.jsxs)("div",{style:{padding:"4px 0"},children:[(0,n.jsx)(v.A,{style:{fontSize:"16px"}}),(0,n.jsx)("div",{children:"Use Custom Name"})]}),value:"custom"}]})}),(0,n.jsxs)("div",{style:{backgroundColor:"#f9f9f9",padding:"16px",borderRadius:"8px",marginBottom:"16px"},children:[(0,n.jsx)(i.A.Item,{name:"name_prefix",label:"Name Prefix",style:{marginBottom:"12px"},children:(0,n.jsx)(b.A,{placeholder:"Dear",onChange:e=>eo("name_prefix")(e.target.value)})}),"custom"===J&&(0,n.jsx)(i.A.Item,{name:"name_text",label:"Custom Name",style:{marginBottom:"12px"},children:(0,n.jsx)(b.A,{placeholder:"Guest",onChange:e=>eo("name_text")(e.target.value)})}),(0,n.jsx)(i.A.Item,{name:"name_postfix",label:"Name Suffix",style:{marginBottom:"0"},children:(0,n.jsx)(b.A,{placeholder:"and Family",onChange:e=>eo("name_postfix")(e.target.value)})})]})]}),(0,n.jsx)(i.A.Item,{name:"type",hidden:!0,children:(0,n.jsx)(b.A,{type:"hidden"})})]})}),(0,n.jsx)(S.A,{xs:24,lg:20,children:(0,n.jsx)(C.Ay,{size:"large",htmlType:"submit",block:!0,type:"primary",className:"mt-4",children:"Next"})})]}),(0,n.jsx)(Q,{visible:K,onCancel:()=>W(!1),type:"cohost"}),(0,n.jsx)(Q,{visible:Z,onCancel:()=>X(!1),type:"invitee"})]})},ei=function({form:e}){let{setEventResources:t,setFullData:a,templateData:l,template:o,uploadedImage:d,youtubeLink:c,cohosts:u,invitees:m,markerState:h,placeName:p,formData:g,updateFormField:x,setCurrent:y}=(0,s.h)(),j=async e=>{Object.keys(e).forEach(t=>{x(t,e[t])});let n=new FormData,{_time:i,_time_to:s,event_date:j,event_date_to:v,event_start_time:f,event_end_time:A,locName:b,csv:_,invitee_validation:w,...C}=e,k="",S="";try{k=(0,r.tj)(g.event_date||"",g.event_start_time)}catch(e){console.error("Error formatting event from date:",e),k=new Date().toISOString()}try{let e=g.event_date_to||g.event_date,t=g.event_end_time||g.event_start_time;S=(0,r.tj)(e||"",t)}catch(e){console.error("Error formatting event to date:",e),S=k||new Date().toISOString()}_&&_[0]?.originFileObj&&n.append("csv_file",_[0].originFileObj,"csv.csv");let I=o||d;I&&n.append("template",I,"file.png"),t(n),a({...C,event_date:k,event_from_date:k,event_to_date:S,event_start_time:g.event_start_time||null,event_end_time:g.event_end_time||null,category_id:l?.category_id||0,template_id:l?.id||0,status:"draft",template_url:"",template_file_id:0,youtube_url:c||"",cohosts:u||[],recipient_contacts:m||[],media_type:c?"youtube":"image",use_contact_names:void 0===e.use_contact_names||e.use_contact_names,name_prefix:e.name_prefix||"",name_text:e.name_text||"Guest",name_postfix:e.name_postfix||"",type:"event",note:e.note||"",csv_ids:e.csv_ids||[],group_ids:e.group_ids||[],location:{name:p||"",latitude:h.lat,longitude:h.lng},is_public:void 0!==e.is_public&&e.is_public,isOwn:!l}),y(3)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(i.A,{style:{display:"flex",flexDirection:"column",gap:"10px"},size:"middle",layout:"vertical",onFinish:j,form:e,initialValues:{_date:null,type:"event",is_public:!1,use_contact_names:!0,csv_ids:[],group_ids:[],name_source:"contact",...g},children:(0,n.jsx)(el,{form:e})})})}},44191:(e,t,a)=>{"use strict";a.d(t,{cp:()=>h,dO:()=>p,jx:()=>m});var n=a(6475);let l=(0,n.createServerReference)("7fe51b929297dbddbf1b0bfba928e70af34e610950",n.callServer,void 0,n.findSourceMapURL,"getSession");a(4749);let i=(0,n.createServerReference)("7fc03f74330daec80a9e1aa0286e4f7e94fb5d90ee",n.callServer,void 0,n.findSourceMapURL,"refreshAccessToken");var s=a(34659);let r=process.env.NEXT_PUBLIC_API_URL,o={"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},d=async(e,t,a=1)=>{try{let a=await fetch(e,{...t,cache:t.cache?t.cache:"no-store"});if(!a.ok){let e=await a.text();if(401===a.status)throw Error("Unauthorized access. Please log in again.");throw Error(e||"Unknown error")}return await a.json()}catch(n){if(a>0)return d(e,t,a-1);throw n}},c=async(e,t={},a={})=>{if(!r)throw Error("API URL is not defined");return d(`${r}${e}`,{...t,headers:{...o,...a,...t.headers}})},u=async(e,t={},a={})=>{let n=await l();if(!r)throw Error("API URL is not defined");let c=`${r}${e}`,u={...t,headers:{...o,...a,...t.headers,Authorization:`Bearer ${n.access_token?n.access_token:"no_token"}`}};try{return await d(c,u)}catch(e){if("Unauthorized access. Please log in again."===e.message&&await i()){n=await l();let e={...u,headers:{...u.headers,Authorization:`Bearer ${n.access_token}`}};return await d(c,e)}throw(403===e.status||401===e.status)&&await (0,s.l)(),e}},m=async()=>c("/api/v1/templates/all/",{method:"GET",cache:"no-store"}),h=async()=>c("/api/v1/categories/?skip=0&limit=100",{method:"GET",cache:"no-store"}),p=async e=>u(`/api/v1/templates/${e}`,{method:"GET",cache:"no-store"})},45473:(e,t,a)=>{"use strict";a.d(t,{A:()=>$});var n=a(60687),l=a(34308),i=a(86072),s=a(77833),r=a(29477),o=a(45281),d=a(43210),c=a.n(d),u=a(67659),m=a(53453);let h=(0,d.forwardRef)(({template:e,selectedElementIndex:t,setSelectedElementIndex:a,updateContent:l,readOnly:i=!1},s)=>{let[r,o]=(0,d.useState)(null),[h,p]=(0,d.useState)(!1),g=(0,d.useRef)(null),x=(0,d.useRef)([]),y=(0,d.useRef)(null);(0,d.useEffect)(()=>{x.current=x.current.slice(0,e.contents.length)},[e.contents.length]),(0,d.useImperativeHandle)(s,()=>({captureImage:()=>g.current?g.current.toDataURL({pixelRatio:2,mimeType:"image/jpeg",quality:.9}):null}));let j=(0,d.useCallback)((t,a,n,l)=>({x:Math.floor(Math.max(0,Math.min(t,e.width-n))),y:Math.floor(Math.max(0,Math.min(a,e.height-l)))}),[e.width,e.height]);(0,d.useEffect)(()=>{if(e.background_image){let t=new Image;if(t.crossOrigin="anonymous",t.onload=()=>o(t),t.onerror=e=>{console.error("Image load error:",e),o(null)},e.background_image instanceof File){let a=URL.createObjectURL(e.background_image);return t.src=a,()=>URL.revokeObjectURL(a)}if("string"==typeof e.background_image){let a=e.background_image.includes("?")?"&":"?";t.src=`/api/image-proxy?url=${encodeURIComponent(e.background_image)}${a}cache=${Date.now()}`}}else o(null)},[e.background_image]);let v=(0,d.useCallback)(e=>{let t=e.target;"Stage"!==t.getType()&&t!==y.current||h||a(null)},[h,a]),f=(0,d.useCallback)((e,t)=>{console.log("Text clicked:",t),e.cancelBubble=!0,e.evt&&(e.evt.preventDefault(),e.evt.stopPropagation()),i||a(t)},[i,a]),A=(0,d.useCallback)((e,t)=>{if(i)return;console.log("Drag start:",t),p(!0),a(t);let n=e.target.getStage()?.container();n&&(n.style.cursor="grabbing")},[i,a]),b=(0,d.useCallback)(e=>{if(i)return;let t=e.target,a=t.width(),n=t.height(),l=j(t.x(),t.y(),a,n);t.x(l.x),t.y(l.y)},[i,j]),_=(0,d.useCallback)((e,t)=>{if(i)return;console.log("Drag end:",t);let a=e.target,n=a.width(),s=a.height(),r=j(a.x(),a.y(),n,s);l(t,{x:r.x,y:r.y}),setTimeout(()=>{p(!1)},50);let o=e.target.getStage()?.container();o&&(o.style.cursor="default")},[i,j,l]),w=(0,d.useCallback)((e,a)=>{if(i)return;let n=e.target.getStage()?.container();n&&!h&&(n.style.cursor=t===a?"grab":"pointer")},[i,h,t]),C=(0,d.useCallback)(e=>{let t=e.target.getStage()?.container();t&&!h&&(t.style.cursor="default")},[h]);return e?(0,n.jsx)("div",{className:"stage-container",children:(0,n.jsx)(u.BI,{width:e.width,height:e.height,ref:g,onMouseDown:v,onTouchStart:v,style:{background:"rgb(236, 236, 236)",boxShadow:"0 0 10px rgba(104, 104, 104, 0.1)",margin:"0 auto",width:e.width,height:e.height},children:(0,n.jsxs)(u.Wd,{ref:y,children:[r&&(0,n.jsx)(u._V,{image:r,width:e.width,height:e.height,listening:!1}),e.contents.map((e,l)=>{let s=x.current[l];return(0,n.jsxs)(c().Fragment,{children:[(0,n.jsx)(u.EY,{ref:e=>{e&&(x.current[l]=e)},text:e.value||"Text",x:e.x||0,y:e.y||0,fontSize:e.font_size||e.size||16,fontFamily:e.font_family||"Arial",fill:e.color?.startsWith("#")?e.color:`#${e.color||"000000"}`,fontStyle:`${e.is_bold?"bold":""} ${e.is_italic?"italic":""}`.trim()||"normal",stroke:e.has_border?"#000000":void 0,strokeWidth:+!!e.has_border,draggable:!i,listening:!0,onMouseDown:e=>f(e,l),onTouchStart:e=>f(e,l),onClick:e=>{e.cancelBubble=!0,i||h||a(l)},onTap:e=>{e.cancelBubble=!0,i||h||a(l)},onDragStart:e=>A(e,l),onDragMove:b,onDragEnd:e=>_(e,l),onMouseEnter:e=>w(e,l),onMouseLeave:C,perfectDrawEnabled:!1,shadowForStrokeEnabled:!1}),t===l&&s&&(0,n.jsx)(u.rw,{x:(e.x||0)-5,y:(e.y||0)-5,width:s.width()+10,height:s.height()+10,stroke:"#1890ff",strokeWidth:2,dash:[4,4],listening:!1,cornerRadius:3})]},`text-element-${l}-${e.value}`)})]})})}):(0,n.jsx)(m.A,{description:"No template selected"})});h.displayName="CanvasEditor";var p=a(92168),g=a(23575),x=a(15999),y=a(53082),j=a(87010),v=a(46945),f=a(79892),A=a(97103),b=a(29494),_=a(73668),w=a(44581),C=a(52935),k=a(36638),S=a(94317),I=a(64054),E=a(78756),T=a(59823),F=a(39100),D=a(33519),L=a(5948),P=a(67501),U=a(52378);let N=["ABeeZee","Abel","Abhaya Libre","Tangerine","Aboreto","Abril Fatface","Abyssinica SIL","Aclonica","Acme","Actor","Adamina","Advent Pro","Aguafina Script","Akaya Kanadaka","Akaya Telivigala","Akronim","Akshar","Aladin","Alata","Alatsi","Albert Sans","Aldrich","Alef","Alegreya","Alegreya SC","Alegreya Sans","Alegreya Sans SC","Aleo","Alex Brush","Alexandria","Alfa Slab One","Alice","Alike","Alike Angular","Alkalami","Allan","Allerta","Allerta Stencil","Allison","Allura","Almarai","Almendra","Almendra Display","Almendra SC","Alumni Sans","Alumni Sans Collegiate One","Alumni Sans Inline One","Alumni Sans Pinstripe","Amarante","Amaranth","Amatic SC","Amethysta","Amiko","Amiri","Amiri Quran","Amita","Anaheim","Andada Pro","Andika","Anek Bangla","Anek Devanagari","Anek Gujarati","Anek Gurmukhi","Anek Kannada","Anek Latin","Anek Malayalam","Anek Odia","Anek Tamil","Anek Telugu","Angkor","Annie Use Your Telescope","Anonymous Pro","Antic","Antic Didone","Antic Slab","Anton","Antonio","Anybody","Arapey"],{Title:R,Text:B}=i.A,{TabPane:z}=_.A,M=e=>N.map(t=>({value:t,label:(0,n.jsx)("span",{style:{fontFamily:t},children:e})})),V=({template:e,updateTemplate:t,selectedElementIndex:a,updateContent:l,selectedContent:i,addContent:r,removeContent:o,handleBackgroundUpload:d,handleSave:c,readOnly:u=!1,setSelectedElementIndex:m,handleThumbnailUpload:h,loading:N,isUser:V})=>{let{data:O,isLoading:Y}=(0,b.I)({queryKey:["categories"],queryFn:p.LZ}),$=(e,t)=>!!e.type.startsWith("image/")&&("background"===t&&d(e),"thumbnail"===t&&h(e),!1);return(0,n.jsxs)("div",{className:"control-panel-content",children:[(0,n.jsxs)(_.A,{defaultActiveKey:"canvas",className:"control-tabs",children:[!V&&(0,n.jsx)(z,{tab:"Canvas",children:(0,n.jsxs)(w.A,{layout:"vertical",children:[(0,n.jsx)(w.A.Item,{label:"Title",children:(0,n.jsx)(C.A,{value:e.title,onChange:e=>t("title",e.target.value),disabled:u})}),(0,n.jsx)(w.A.Item,{label:"Canvas Size",children:(0,n.jsxs)(k.A,{children:[(0,n.jsx)(S.A,{addonBefore:"Width",min:200,max:3e3,value:e.width,onChange:e=>t("width",e),disabled:u}),(0,n.jsx)(S.A,{addonBefore:"Height",min:200,max:3e3,value:e.height,onChange:e=>t("height",e),disabled:u})]})}),(0,n.jsx)(w.A.Item,{label:"Background",children:(0,n.jsx)(I.A,{name:"background",listType:"picture-card",showUploadList:!1,beforeUpload:e=>$(e,"background"),disabled:u,children:e.background_image?(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("img",{src:"string"==typeof e.background_image?e.background_image:URL.createObjectURL(e.background_image),alt:"Background",style:{width:"100%"}}),(0,n.jsx)("div",{style:{position:"absolute",top:0,right:0,background:"rgba(0,0,0,0.65)",color:"#fff",cursor:"pointer",padding:"4px"},onClick:e=>{e.stopPropagation(),t("background_image",null)},children:(0,n.jsx)(g.A,{})})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)(x.A,{}),(0,n.jsx)("div",{style:{marginTop:8},children:"Upload"})]})})}),(0,n.jsx)(w.A.Item,{label:"Thumbnail",children:(0,n.jsx)(I.A,{name:"thumbnail",listType:"picture-card",showUploadList:!1,beforeUpload:e=>$(e,"thumbnail"),disabled:u,children:e.thumbnail_url?(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("img",{src:"string"==typeof e.thumbnail_url?e.thumbnail_url:URL.createObjectURL(e.thumbnail_url),alt:"thumbnail",style:{width:"100%"}}),(0,n.jsx)("div",{style:{position:"absolute",top:0,right:0,background:"rgba(0,0,0,0.65)",color:"#fff",cursor:"pointer",padding:"4px"},onClick:e=>{e.stopPropagation(),t("thumbnail_url",null)},children:(0,n.jsx)(g.A,{})})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)(x.A,{}),(0,n.jsx)("div",{style:{marginTop:8},children:"Upload"})]})})}),(0,n.jsx)(w.A.Item,{label:"Template Type",children:(0,n.jsx)(E.A,{popupMatchSelectWidth:!1,loading:Y,options:O?.map(e=>({value:e.id,label:e.name})),onChange:e=>t("category_id",e)})}),(0,n.jsx)(w.A.Item,{label:"Description",children:(0,n.jsx)(C.A.TextArea,{value:e.description||"",onChange:e=>t("description",e.target.value),rows:3,disabled:u})}),(0,n.jsx)(w.A.Item,{children:(0,n.jsxs)(k.A,{children:[(0,n.jsx)(T.A,{checked:e.is_public,onChange:e=>t("is_public",e),disabled:u}),(0,n.jsx)(B,{children:"Public"})]})}),(0,n.jsx)(w.A.Item,{children:(0,n.jsxs)(k.A,{children:[(0,n.jsx)(T.A,{checked:e.is_premium,onChange:e=>t("is_premium",e),disabled:u}),(0,n.jsx)(B,{children:"Premium"})]})}),e.is_premium&&(0,n.jsx)(w.A.Item,{label:"Price in Credits",children:(0,n.jsx)(S.A,{min:0,value:e.price_in_credits,onChange:e=>t("price_in_credits",e),disabled:u,style:{width:"100%"}})})]})},"canvas"),(0,n.jsxs)(z,{tab:"Text Elements",children:[!V&&!u&&(0,n.jsx)(s.Ay,{type:"dashed",icon:(0,n.jsx)(y.A,{}),onClick:()=>r(),block:!0,style:{marginBottom:16},children:"Add Text"}),null!==a&&i&&(0,n.jsxs)(w.A,{layout:"vertical",children:[(0,n.jsx)(R,{level:5,children:"Edit Text Element"}),(0,n.jsx)(s.Ay,{style:{width:"100%",marginBottom:12},onClick:()=>m(null),children:"Remove selection"}),(0,n.jsx)(w.A.Item,{label:"Text Content",children:(0,n.jsx)(C.A.TextArea,{value:i.value,onChange:e=>l(a,{value:e.target.value}),rows:3,disabled:u})}),(0,n.jsx)(w.A.Item,{label:"Position",children:(0,n.jsxs)(k.A,{children:[(0,n.jsx)(S.A,{addonBefore:"X",value:i.x,onChange:e=>l(a,{x:e}),disabled:u}),(0,n.jsx)(S.A,{addonBefore:"Y",value:i.y,onChange:e=>l(a,{y:e}),disabled:u})]})}),(0,n.jsx)(w.A.Item,{label:"Font",children:(0,n.jsx)(E.A,{value:i.font_family,onChange:e=>l(a,{font_family:e}),disabled:u,style:{width:"100%"},options:M(i.value)})}),(0,n.jsx)(w.A.Item,{label:"Font Size",children:(0,n.jsx)(S.A,{min:8,max:120,value:i.font_size||i.size,onChange:e=>l(a,{font_size:e,size:e}),disabled:u,style:{width:"100%"}})}),(0,n.jsx)(w.A.Item,{label:"Color",children:(0,n.jsx)(F.A,{value:i.color,onChange:e=>l(a,{color:e.toHex()}),disabled:u})}),(0,n.jsx)(w.A.Item,{children:(0,n.jsxs)(k.A,{children:[(0,n.jsx)(D.A,{title:"Bold",children:(0,n.jsx)(s.Ay,{icon:(0,n.jsx)(j.A,{}),type:i.is_bold?"primary":"default",onClick:()=>l(a,{is_bold:!i.is_bold}),disabled:u})}),(0,n.jsx)(D.A,{title:"Italic",children:(0,n.jsx)(s.Ay,{icon:(0,n.jsx)(v.A,{}),type:i.is_italic?"primary":"default",onClick:()=>l(a,{is_italic:!i.is_italic}),disabled:u})}),(0,n.jsx)(D.A,{title:"Border",children:(0,n.jsx)(s.Ay,{icon:(0,n.jsx)(f.A,{}),type:i.has_border?"primary":"default",onClick:()=>l(a,{has_border:!i.has_border}),disabled:u})})]})}),!V&&!u&&(0,n.jsx)(s.Ay,{danger:!0,icon:(0,n.jsx)(g.A,{}),onClick:()=>o(a),block:!0,children:"Remove Element"})]}),null===a&&e.contents.length>0&&(0,n.jsxs)("div",{className:"elements-list",children:[(0,n.jsx)(R,{level:5,children:"Select Element to Edit"}),e.contents.map((e,t)=>(0,n.jsx)("div",{className:"element-item",onClick:()=>m(t),children:(0,n.jsx)(B,{ellipsis:!0,style:{width:"100%"},children:e.value||"Empty text"})},t))]})]},"elements")]}),(0,n.jsx)(L.A,{style:{margin:"12px 0"}}),V&&null!==a?(0,n.jsx)(P.A,{className:"warning-message",justify:"center",children:(0,n.jsx)(U.A,{color:"red",children:"Remove Selection to continue"})}):(0,n.jsx)(s.Ay,{type:"primary",icon:V?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(A.A,{}),onClick:c,block:!0,disabled:V&&null!==a,loading:N,children:V?"Next":u?"Use Template":"Save Template"})]})};a(50763);let{Title:O}=i.A,Y={title:"",subtitle:"",description:"",category_id:0,height:600,width:800,contents:[],is_public:!1,is_premium:!1,is_active:!0,background_image:null,price_in_credits:0,template_type:"",id:0,user_id:0,created_at:"",preview_images:[]},$=(0,d.forwardRef)(({initialTemplate:e={},onSave:t=()=>{},readOnly:a=!1,isUser:i=!1,loading:c=!1},u)=>{let[m,p]=(0,d.useState)({...Y,...{...e,background_image:e?.file_url}}),g=(0,d.useRef)(null);(0,d.useImperativeHandle)(u,()=>({captureImage:()=>g.current?g.current.captureImage():null}));let[x,y]=(0,d.useState)(null),[j,v]=(0,d.useState)(1024),[f,A]=(0,d.useState)(!1);(0,d.useEffect)(()=>{let e=()=>{v(window.innerWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let b=(e,t)=>{p(a=>{let n=[...a.contents];return n[e]={...n[e],...t},{...a,contents:n}})},_=(0,n.jsx)(V,{isUser:i,handleThumbnailUpload:e=>{e&&p(t=>({...t,thumbnail_url:e}))},setSelectedElementIndex:y,template:m,updateTemplate:(e,t)=>{p(a=>({...a,[e]:t}))},selectedElementIndex:x,updateContent:b,selectedContent:null!==x?m.contents[x]:null,addContent:(e={})=>{let t={value:"New Text",x:50,y:50,font_family:"Arial",color:"#000000",size:16,is_bold:!1,is_italic:!1,has_border:!1,font_size:16,...e};p(e=>({...e,contents:[...e.contents,t]})),y(m.contents.length)},removeContent:e=>{p(t=>({...t,contents:t.contents.filter((t,a)=>a!==e)})),x===e&&y(null)},handleBackgroundUpload:e=>{e&&p(t=>({...t,background_image:e}))},handleSave:()=>{try{t(m)}catch(e){console.error("Failed to save template")}},readOnly:a,loading:c}),w=(0,n.jsx)(s.Ay,{type:"primary",shape:"circle",icon:(0,n.jsx)(l.A,{}),size:"large",onClick:()=>A(!0),style:{position:"fixed",bottom:180,right:24,zIndex:1e3,boxShadow:"0 3px 6px rgba(0,0,0,0.16)"}});return(0,n.jsx)(n.Fragment,{children:j<=768?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h,{ref:g,template:m,selectedElementIndex:x,setSelectedElementIndex:y,updateContent:b,readOnly:a}),(0,n.jsx)(r.A,{title:"Template Editor",placement:"right",onClose:()=>A(!1),open:f,width:320,children:_}),w]}):(0,n.jsxs)(o.A,{style:{boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)"},children:[(0,n.jsx)(o.A.Panel,{min:"25%",children:(0,n.jsx)(h,{ref:g,template:m,selectedElementIndex:x,setSelectedElementIndex:y,updateContent:b,readOnly:a})}),(0,n.jsx)(o.A.Panel,{defaultSize:"25%",resizable:!1,collapsible:!0,max:"25%",className:"",children:(0,n.jsxs)("div",{style:{padding:"1rem",overflowY:"auto",height:m.height},children:[(0,n.jsx)(O,{style:{textAlign:"center"},level:4,children:"Customize your template"}),_]})})]})})})},47533:(e,t,a)=>{"use strict";a.d(t,{_:()=>i});var n=a(34280);let l=["places"],i=()=>{let{isLoaded:e,loadError:t}=(0,n.KD)({id:"google-map-script",googleMapsApiKey:process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY||"AIzaSyAvI6vu7WINuMtM6qBzmHO2m9r3U3jZBCo",libraries:l});return{isLoaded:e,loadError:t}}},48714:(e,t,a)=>{"use strict";a.d(t,{A:()=>y});var n=a(60687),l=a(43210),i=a(90465),s=a.n(i),r=a(74018),o=a(64054),d=a(52935),c=a(77833),u=a(10678),m=a(73668),h=a(99530),p=a(33871),g=a(15999),x=a(83639);let y=function(){let{setUploadedImage:e,setTemplateData:t,setCurrent:a,setYoutubeLink:i,setMediaType:y}=(0,p.h)(),[j,v]=(0,l.useState)(!1),[f,A]=(0,l.useState)(""),b=[{key:"image",label:(0,n.jsxs)("span",{children:[(0,n.jsx)(g.A,{})," Upload Image"]}),children:(0,n.jsx)(h.A,{style:{background:"#fc5b3f1d"},customRequest:({onSuccess:e})=>setTimeout(()=>{e("ok",null)},0),accept:"image/*",name:"file",maxCount:1,action:void 0,fileList:void 0,onRemove(){},async beforeUpload(n){if("image/jpeg"!==n.type&&"image/png"!==n.type&&"image/jpg"!==n.type)return o.A.LIST_IGNORE;e(n),y("image"),t();let l=new Image;return l.onload=()=>{p.h.getState().setImageSize({width:l.width,height:l.height}),a(1)},l.src=URL.createObjectURL(n),v(!1),!1},children:(0,n.jsx)("span",{className:s().uploadText,children:"Upload Your Own Design or Photo"})})},{key:"youtube",label:(0,n.jsxs)("span",{children:[(0,n.jsx)(x.A,{})," YouTube Link"]}),children:(0,n.jsxs)("div",{className:s().youtubeContainer,children:[(0,n.jsx)("p",{children:"Enter YouTube video URL:"}),(0,n.jsx)(d.A,{placeholder:"https://www.youtube.com/watch?v=...",value:f,onChange:e=>A(e.target.value),style:{marginBottom:16}}),(0,n.jsx)(c.Ay,{type:"primary",onClick:()=>{if(!/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+$/.test(f)){r.Ay.error("Please enter a valid YouTube URL");return}i(f),y("youtube"),t(),a(1),v(!1)},children:"Submit"})]})}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Ay,{onClick:()=>{v(!0)},type:"primary",style:{fontSize:"24px",width:"100%",height:"120px",padding:"16px",background:"#fc5b3f1d",color:"#333",border:"dotted 1px #fc5b3f"},children:"Upload Your Own Media (Image or YouTube)"}),(0,n.jsx)(u.A,{title:"Choose Media Type",open:j,onCancel:()=>{v(!1)},footer:null,width:600,children:(0,n.jsx)(m.A,{defaultActiveKey:"image",items:b})})]})}},50763:()=>{},71635:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(60687);a(43210);let l=function({url:e,width:t=560,height:a=315}){let l=e.includes("youtu.be/")?e.split("youtu.be/")[1]?.split(/[?&]/)[0]||"":new URL(e).searchParams.get("v")||"",i=`https://www.youtube.com/embed/${l}`;return(0,n.jsx)("div",{style:{width:t,maxWidth:"100%"},children:(0,n.jsx)("div",{style:{position:"relative",paddingBottom:"56.25%",height:0,overflow:"hidden"},children:(0,n.jsx)("iframe",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},width:t,height:a,src:i,title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})}},81293:()=>{},90465:e=>{e.exports={categoriesContainer:"style_categoriesContainer___E9_d",templateImagesContainer:"style_templateImagesContainer__EJ_3q",uploadText:"style_uploadText__2UVRj",loadingOverlay:"style_loadingOverlay__ZBKn_",imageContainer:"style_imageContainer__aeYK_",image:"style_image__NjMeu",overlay:"style_overlay__ad28q",overlayText:"style_overlayText__ulTkK"}},92168:(e,t,a)=>{"use strict";a.d(t,{I7:()=>r,JW:()=>m,LZ:()=>d,Tj:()=>s,mn:()=>l,nt:()=>o,tA:()=>h,ub:()=>i,ul:()=>c,yW:()=>u});var n=a(43313);async function l(e){try{return await n.y1.post("templates/",e)}catch(e){throw Error(e)}}async function i(e,t){try{return await n.y1.put(`templates/${t}`,e)}catch(e){throw Error(e)}}async function s(e){try{return await n.y1.post("templates/upload-template-images/",e,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){throw Error(e)}}async function r(e){try{return await n.y1.delete(`templates/${e}`)}catch(e){throw Error(e)}}async function o(){try{return await n.y1.get("templates/?skip=0&limit=100")}catch(e){throw Error(e)}}async function d(){try{return await n.f6.get("categories/?skip=0&limit=100")}catch(e){throw Error(e)}}async function c(e){try{return await n.y1.delete(`categories/${e}`)}catch(e){throw Error(e)}}async function u(e){try{return await n.y1.post("categories/",e)}catch(e){throw Error(e)}}async function m(e){try{return await n.y1.put(`categories/${e.id}`,e)}catch(e){throw Error(e)}}async function h(e){try{return await n.y1.post("categories/upload-image",e,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){throw Error(e)}}},95896:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var n=a(60687),l=a(45473),i=a(71635),s=a(33871),r=a(85975),o=a(74018),d=a(67501),c=a(77833),u=a(70553),m=a(53453),h=a(30474),p=a(43210);let g=function(){let{template:e,uploadedImage:t,youtubeLink:a,templateData:g,setTemplate:x,setTemplateData:y,setImageSize:j,setCurrent:v,setUploadedImage:f,setYoutubeLink:A}=(0,s.h)(),b=(0,p.useRef)(null),[_,w]=o.Ay.useMessage(),[C,k]=(0,p.useState)(!1),S=async e=>{if(b.current){k(!0);try{let t=b.current.captureImage();if(!t)throw Error("Failed to capture template image");let a=g?.width||600,n=g?.height||800;j({width:a,height:n});let l=await fetch(t),i=await l.blob();x(i),y(e),v(2),_.success("Template saved successfully!")}catch(e){console.error(e),_.error("Error saving template. Please try again.")}finally{k(!1)}}},I=()=>{v(2)},E=()=>{A(null),f(void 0),v(0)};return a&&!g?(0,n.jsxs)(n.Fragment,{children:[w,(0,n.jsx)(d.A,{justify:"space-between",className:"mb-3",children:(0,n.jsx)(c.Ay,{onClick:E,icon:(0,n.jsx)(r.A,{}),type:"link",children:"Go back"})}),(0,n.jsxs)(d.A,{vertical:!0,align:"center",gap:20,style:{padding:"20px"},children:[(0,n.jsx)("h3",{children:"Your YouTube Video"}),(0,n.jsx)(i.A,{url:a,width:560,height:315}),(0,n.jsx)(c.Ay,{type:"primary",onClick:I,children:"Continue to Event Details"})]})]}):t&&!g?(0,n.jsxs)(n.Fragment,{children:[w,(0,n.jsx)(d.A,{justify:"space-between",className:"mb-3",children:(0,n.jsx)(c.Ay,{onClick:E,icon:(0,n.jsx)(r.A,{}),type:"link",children:"Go back"})}),(0,n.jsxs)("div",{style:{textAlign:"center",padding:"20px"},children:[(0,n.jsx)("h3",{children:"Your uploaded design"}),(0,n.jsx)(h.default,{src:URL.createObjectURL(t),alt:"Uploaded design",width:300,height:400,style:{objectFit:"contain",maxHeight:"500px"}}),(0,n.jsx)("div",{style:{marginTop:"20px"},children:(0,n.jsx)(c.Ay,{type:"primary",onClick:I,children:"Continue to Event Details"})})]})]}):g?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.A,{justify:"space-between",children:(0,n.jsx)(c.Ay,{onClick:E,icon:(0,n.jsx)(r.A,{}),type:"link",children:"Go back"})}),w,C&&(0,n.jsx)("div",{style:{textAlign:"center",margin:"10px 0"},children:(0,n.jsx)(u.A,{})}),(0,n.jsx)(l.A,{ref:b,isUser:!0,initialTemplate:g,onSave:S})]}):(0,n.jsx)(m.A,{description:"Please select a template or upload your own design first"})}},96340:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});var n=a(60687),l=a(67501),i=a(43210),s=a(16135),r=a(24937),o=a(4228),d=a(77833),c=a(44191),u=a(33871),m=a(74018),h=a(53453),p=a(30474),g=a(90465),x=a.n(g);let y=function({templates:e,limit:t,catId:a}){let{setTemplateData:s,setUploadedImage:r,setImageSize:o,setCurrent:d}=(0,u.h)(),[g,y]=(0,i.useState)(null),[j,v]=m.Ay.useMessage(),f=async e=>{try{y(e.id),r(void 0);let t=await (0,c.dO)(`${e.id}`);s(t),o({width:t.width||600,height:t.height||800}),d(1),j.success("Template selected successfully!")}catch(e){console.error("Error fetching template:",e),j.error("Failed to load template details. Please try again.")}finally{y(null)}},A=t?e.slice(0,6):e;return(0,n.jsxs)("div",{className:x().templateImagesContainer,children:[v,A?.length!==0?(0,n.jsx)(n.Fragment,{children:A.map(e=>(0,n.jsxs)("div",{className:x().imageContainer,onClick:()=>f(e),style:{cursor:"pointer",position:"relative"},children:[g===e.id&&(0,n.jsx)("div",{className:x().loadingOverlay,children:"Loading..."}),"string"==typeof e?.thumbnail_url&&(e.thumbnail_url.includes("http://")||e.thumbnail_url.includes("https://"))&&(0,n.jsx)(p.default,{src:e?.thumbnail_url,alt:"template image",height:250,width:200,style:{objectFit:"cover",objectPosition:"center"}}),(0,n.jsx)("div",{className:x().overlay,children:(0,n.jsx)("div",{className:x().overlayText,children:"Use Template"})})]},e.id))}):(0,n.jsx)(l.A,{style:{width:"100%"},justify:"center",children:(0,n.jsx)(h.A,{description:"No template found"})})]})},j=function({category:e,templates:t,searchParams:a}){let{token:{colorPrimary:c}}=r.A.useToken(),[u,m]=o.Ay.useNotification(),[h,p]=(0,i.useState)(!0);return(0,n.jsxs)(n.Fragment,{children:[m,(0,n.jsxs)(l.A,{align:"center",justify:"space-between",children:[(0,n.jsx)(s.A,{style:{fontSize:"2rem",borderBottom:`3px solid ${c}`},children:e.name}),(0,n.jsx)(d.Ay,{onClick:()=>p(e=>!e),type:"link",children:"View All"})]}),(0,n.jsx)(y,{catId:e.id,limit:h,templates:t})]})};var v=a(48714);let f=function({templates:e,categories:t}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{marginTop:24,marginBottom:24},children:(0,n.jsx)(v.A,{})}),(0,n.jsx)(l.A,{vertical:!0,gap:24,children:t.map(t=>{let a=e.filter(e=>e.category.id===t.id);return(0,n.jsx)(j,{templates:a,category:t},t.id)})})]})}}};