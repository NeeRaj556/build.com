(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5189],{11206:(e,t,r)=>{"use strict";r.d(t,{default:()=>x});var s=r(95155),a=r(86769),n=r(12133),i=r(64778),o=r(52319),l=r(5041),c=r(66188),u=r(94326),d=r(46002),m=r(26922),p=r(77325),y=r(20534),h=r(31506),j=r(17238),f=r(12115);let{Dragger:g}=c.A,x=function(){let[e,t]=(0,f.useState)(!1),[r,x]=u.Ay.useMessage(),A=(0,l.n)({mutationFn:o.VN,onError:e=>{r.error("Image upload failed."),c.A.LIST_IGNORE}}),v=(0,l.n)({mutationFn:o.fu,onSuccess:e=>{r.success("Credits Requested Suceessfully"),t(!1)},onError:e=>{r.error(e.message)}});return(0,s.jsxs)("div",{children:[x,(0,s.jsxs)(i.default,{type:"link",onClick:()=>t(!0),icon:(0,s.jsx)(a.A,{}),children:["New credit request"," "]}),(0,s.jsx)(d.A,{title:(0,s.jsxs)(s.Fragment,{children:["Request Credits",(0,s.jsx)(m.A,{title:"You need to transfer money to our esewa account then upload its statement in order to get credits.",color:"#f50",children:(0,s.jsx)(p.Ay,{type:"link",icon:(0,s.jsx)(n.A,{})})})]}),open:e,onOk:()=>t(!1),onCancel:()=>t(!1),footer:null,children:(0,s.jsxs)(y.A,{layout:"vertical",onFinish:e=>{if(!e.image){r.error("Please upload an image.");return}let t=new FormData,s=e.image[0].originFileObj;t.append("image",s,"image.".concat(s.type.split("/")[1])),A.mutate(t,{onSuccess:t=>{v.mutate({image_url:t.image_url,requested_amount:e.requested_amount})}})},children:[(0,s.jsx)(y.A.Item,{name:"requested_amount",required:!0,rules:[{required:!0,message:"Please enter your requested amount"}],label:"Enter your requested amount",children:(0,s.jsx)(h.A,{})}),(0,s.jsx)(y.A.Item,{name:"image",required:!0,label:"Receipt image",rules:[{required:!0,message:"Please enter your requested amount"}],valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:null==e?void 0:e.fileList,children:(0,s.jsx)(g,{customRequest:e=>{let{onSuccess:t}=e;return setTimeout(()=>{t("ok",null)},0)},accept:"image/*",name:"file",maxCount:1,action:void 0,fileList:void 0,children:(0,s.jsx)("p",{className:"ant-upload-text",children:"Click or drag receipt image to this area to upload"})})}),(0,s.jsx)("br",{}),(0,s.jsxs)(j.A,{justify:"space-between",children:[(0,s.jsx)(p.Ay,{onClick:()=>t(!1),type:"primary",danger:!0,children:"Cancel"}),(0,s.jsx)(p.Ay,{htmlType:"submit",loading:A.isPending||v.isPending,type:"primary",children:"Submit"})]})]})})]})}},37646:(e,t,r)=>{Promise.resolve().then(r.bind(r,95658)),Promise.resolve().then(r.bind(r,87626)),Promise.resolve().then(r.bind(r,11206)),Promise.resolve().then(r.bind(r,65447))},49561:(e,t,r)=>{"use strict";r.d(t,{f6:()=>o,y1:()=>l});var s=r(23464),a=r(86774),n=r(98243);let i="https://backend.enimto.com/api/v1/",o=s.A.create({baseURL:i,headers:{"Content-Type":"application/json",accept:"application/json"}});o.interceptors.response.use(e=>e.data,e=>e.response?Promise.reject(e.response.data.detail):Promise.reject(e.message));let l=s.A.create({baseURL:i,headers:{"Content-Type":"application/json",accept:"application/json"}});l.interceptors.request.use(async e=>{let t=await (0,a.g)();return e.headers.Authorization="Bearer ".concat(t.access_token?t.access_token:"no_token"),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e.data,async e=>{if(!e.response)return Promise.reject(e.message);{let t=e.response.status,r=e.response.data.detail;return(403===t||401===t)&&await (0,n.l)(),Promise.reject(r)}})},52319:(e,t,r)=>{"use strict";r.d(t,{Sd:()=>a,VN:()=>i,fu:()=>o,hJ:()=>n});var s=r(49561);async function a(){try{return await s.y1.get("credit-requests/")}catch(e){throw Error(e)}}async function n(e){try{return await s.y1.put("credit-requests/".concat(e.id),e.details)}catch(e){throw Error(e)}}async function i(e){try{return await s.y1.post("credit-requests/upload/",e,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){throw Error(e)}}async function o(e){try{return await s.y1.post("credit-requests/",e)}catch(e){throw Error(e)}}},61860:e=>{e.exports={floatButton:"styles_floatButton__HeivV"}},64778:(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var s=r(95155),a=r(70445),n=r(77325);r(12115);var i=r(61860),o=r.n(i);let l=function(e){let{onClick:t,icon:r,children:i,type:l}=e,{token:{colorBgBase:c}}=a.A.useToken();return(0,s.jsx)("div",{style:{background:c},className:o().floatButton,onClick:t,children:(0,s.jsx)(n.Ay,{block:!0,size:"large",icon:r,type:l,children:i})})}},65447:(e,t,r)=>{"use strict";r.d(t,{default:()=>d});var s=r(95155),a=r(52319),n=r(19373),i=r(31086),o=r(6124),l=r(35125),c=r(36768);function u(){return(0,s.jsx)(c.A,{})}r(12115);let d=function(){let{data:e,isLoading:t,isError:r,isSuccess:c}=(0,n.I)({queryKey:["creditRequests"],queryFn:a.Sd,retry:4});if(console.log(e),r)return(0,s.jsx)(i.Ay,{title:"Error getting results",status:"error"});if(t)return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{size:"small",loading:!0}),(0,s.jsx)(o.A,{size:"small",loading:!0})]});if(c){let e=[{label:"All",key:"1",children:(0,s.jsx)(u,{})},{label:"Approved",key:"2",children:(0,s.jsx)(u,{})},{label:"Rejected",key:"3",children:(0,s.jsx)(u,{})},{label:"Spent",key:"4",children:(0,s.jsx)(u,{})}];return(0,s.jsx)(o.A,{style:{border:"1px solid rgba(0,0,0,0)"},size:"small",children:(0,s.jsx)(l.A,{items:e})})}return null}},86774:(e,t,r)=>{"use strict";r.d(t,{g:()=>a});var s=r(34477);let a=(0,s.createServerReference)("7f2a6a67a7d279a82b25025e99ca3a830397cdc38b",s.callServer,void 0,s.findSourceMapURL,"getSessionClient")},95658:(e,t,r)=>{"use strict";r.d(t,{Card:()=>s.A,Flex:()=>a.A});var s=r(6124),a=r(17238)},98243:(e,t,r)=>{"use strict";r.d(t,{l:()=>a});var s=r(34477);let a=(0,s.createServerReference)("7f1a247a9be4835b7241064d2136726da767e5e7e5",s.callServer,void 0,s.findSourceMapURL,"destroySession")}},e=>{var t=t=>e(e.s=t);e.O(0,[2027,4666,86,3876,3749,8646,8085,7325,6124,6922,1086,9186,5144,7845,3889,9237,2788,4714,534,5201,1105,6002,2160,1506,7930,8441,1684,7358],()=>t(37646)),_N_E=e.O()}]);