(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4920],{27720:(e,t,s)=>{Promise.resolve().then(s.bind(s,45626)),Promise.resolve().then(s.bind(s,48882)),Promise.resolve().then(s.bind(s,67017))},67017:(e,t,s)=>{"use strict";s.d(t,{default:()=>Q});var i=s(95155),r=s(15825),n=s(20534),l=s(6124),a=s(77517),o=s(4e4),c=s(80664),d=s(86917),h=s(88077),m=s(86491),p=s(4601),x=s(12388),g=s(95759),j=s(81730),y=s(24073),u=s(3231),f=s(12088),A=s(58735),v=s(96097),_=s(50274),b=s(38919),w=s(67678),k=s(19558),E=s(54160),S=s(26715),z=s(5041),C=s(81535),F=s(94326),R=s(36768),B=s(17238),D=s(77325),M=s(97226),N=s(94600),O=s(19361),P=s(74947),H=s(28562),U=s(30832),T=s.n(U);let{Title:I,Text:L,Paragraph:K}=C.A,W=function(){let e=(0,x.rd)(),t=(0,S.jE)(),{breakpoint:s}=(0,g.l)(),{fullData:n,imageSize:a,template:o,uploadedImage:c,youtubeLink:C,cohosts:U,invitees:W,setCurrent:q,formData:G}=(0,r.h)(),[Q,Z]=F.Ay.useMessage(),{uploadFileDirect:J,isUploading:V}=(0,p.Z)(),X=(0,z.n)({mutationFn:m.lh,onError:e=>{Q.error(e.message)},onSuccess:(s,i)=>{Q.success("Nimto sent successfully"),e.push("/user/create-event/success?status=".concat(i.status)),t.invalidateQueries({queryKey:["userData"]})}});if(!n||!(c||o||C))return(0,i.jsx)(R.A,{description:"Please complete previous steps first",style:{margin:"100px auto"}});let Y=async e=>{try{let t;if(C){let{isOwn:t,...s}=n,i={...s,status:e,template_url:C,cohosts:U||[],recipient_contacts:W||[],csv_ids:Array.isArray(n.csv_ids)?n.csv_ids:[],group_ids:Array.isArray(n.group_ids)?n.group_ids:[],category_id:n.category_id||null,template_id:n.template_id||null,template_file_id:0};X.mutate(i);return}let s=n.isOwn?c:o;if(!s)throw Error("No file to upload");if(s instanceof File)t=s;else{let e=n.isOwn?"custom-template-".concat(Date.now(),".jpg"):"template-".concat(n.template_id||Date.now(),".jpg");t=new File([s],e,{type:s.type||"image/jpeg",lastModified:Date.now()})}let i=await J(t,{purpose:"event_template",description:"Event template for ".concat(n.title),folder:"event-templates"});if("success"!==i.status)throw Error("Upload failed");let{isOwn:r,...l}=n,a={...l,status:e,template_url:i.publicUrl||i.downloadUrl||"",cohosts:U||[],recipient_contacts:W||[],csv_ids:Array.isArray(n.csv_ids)?n.csv_ids:[],group_ids:Array.isArray(n.group_ids)?n.group_ids:[],category_id:n.category_id||null,template_id:n.template_id&&n.template_id>0?n.template_id:null,template_file_id:i.fileId};X.mutate(a)}catch(e){Q.error("Upload failed: ".concat(e instanceof Error?e.message:"Unknown error"))}},{width:$,height:ee}=((e,t,s)=>{let i=e>600?600:e;return{width:i,height:t/e*i}})(n.isOwn?330:a.width,a.height,600),et=e=>e?new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}):"",es=X.isPending||V;return(0,i.jsxs)(i.Fragment,{children:[Z,(0,i.jsxs)(B.A,{justify:"space-between",align:"center",className:"mb-4",children:[(0,i.jsx)(D.Ay,{onClick:()=>q(2),icon:(0,i.jsx)(j.A,{}),type:"text",size:"large",children:"Go back"}),(0,i.jsx)(I,{level:4,style:{margin:0},children:"Event Preview"}),(0,i.jsx)("div",{style:{width:90}})," "]}),(0,i.jsxs)(l.A,{bordered:!0,style:{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.08)",borderRadius:"8px",overflow:"hidden",maxWidth:"900px",margin:"0 auto"},bodyStyle:{padding:s?16:24},children:[(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:24,backgroundColor:"#f5f5f5",borderRadius:"8px",padding:"20px"},children:C?(0,i.jsx)(h.A,{url:C,width:s?330:Math.min($,600),height:s?186:Math.min(ee,338)}):(0,i.jsx)(d.A,{alt:"Event image",src:URL.createObjectURL(((null==n?void 0:n.isOwn)?c:o)||new Blob),fallback:!0,style:{width:s?330:Math.min($,600),height:n.isOwn?"auto":s?.7*ee:ee,borderRadius:"6px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"}})}),(0,i.jsxs)("div",{style:{padding:"0 8px"},children:[(0,i.jsx)(I,{level:3,style:{marginTop:0,marginBottom:16},children:n.title}),(0,i.jsxs)(M.A,{direction:"vertical",size:"middle",style:{width:"100%",marginBottom:24},children:[(0,i.jsxs)(B.A,{align:"center",gap:12,children:[(0,i.jsx)(y.A,{style:{fontSize:18,color:"#1677ff"}}),(0,i.jsxs)(L,{strong:!0,children:[et(G.event_date||"")," ",G.event_date_to&&(0,i.jsxs)(i.Fragment,{children:["to ",et(G.event_date_to||"")]})]})]}),(0,i.jsxs)(B.A,{align:"center",gap:12,children:[(0,i.jsx)(u.A,{style:{fontSize:18,color:"#1677ff"}}),(0,i.jsxs)(L,{children:[T()(G.event_start_time,"HH:mm:ss").format("h:mm A")," ",G.event_end_time&&(0,i.jsxs)(i.Fragment,{children:["to"," ",T()(G.event_end_time,"HH:mm:ss").format("h:mm A")]})]})]}),(0,i.jsxs)(B.A,{align:"center",gap:12,children:[(0,i.jsx)(f.A,{style:{fontSize:18,color:"#1677ff"}}),(0,i.jsx)(L,{children:n.venue})]})]}),(0,i.jsx)(N.A,{}),(0,i.jsxs)("div",{style:{marginBottom:24},children:[(0,i.jsxs)(I,{level:5,children:[(0,i.jsx)(A.A,{style:{marginRight:8}}),"About this event"]}),(0,i.jsx)(K,{style:{fontSize:16},children:n.description})]}),n.rich_description&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(N.A,{}),(0,i.jsxs)("div",{style:{marginBottom:24},children:[(0,i.jsx)(I,{level:5,children:"Details"}),(0,i.jsx)("div",{className:"rich-description",dangerouslySetInnerHTML:{__html:n.rich_description},style:{fontSize:16,lineHeight:1.6,padding:8}})]})]}),n.sms&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(N.A,{}),(0,i.jsxs)("div",{style:{marginBottom:24},children:[(0,i.jsxs)(I,{level:5,children:[(0,i.jsx)(A.A,{style:{marginRight:8}}),"SMS Notification"]}),(0,i.jsx)(l.A,{size:"small",style:{backgroundColor:"#f9f9f9",borderRadius:6},children:(0,i.jsx)(L,{children:n.sms})})]})]}),U&&U.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(N.A,{}),(0,i.jsxs)("div",{style:{marginBottom:24},children:[(0,i.jsxs)(I,{level:5,children:[(0,i.jsx)(v.A,{style:{marginRight:8}}),"Co-hosts"]}),(0,i.jsx)(O.A,{gutter:[16,16],children:U.map((e,t)=>(0,i.jsx)(P.A,{xs:24,sm:12,children:(0,i.jsx)(l.A,{size:"small",bordered:!0,style:{borderRadius:6},children:(0,i.jsxs)(B.A,{align:"center",gap:12,children:[(0,i.jsx)(H.A,{icon:(0,i.jsx)(_.A,{}),style:{backgroundColor:"#1677ff"}}),(0,i.jsxs)("div",{children:[(0,i.jsx)(L,{strong:!0,style:{display:"block"},children:e.name}),(0,i.jsxs)(B.A,{align:"center",gap:4,children:[(0,i.jsx)(b.A,{style:{fontSize:12,color:"#666"}}),(0,i.jsx)(L,{type:"secondary",children:e.phone_number})]})]})]})})},t))})]})]}),W&&W.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(N.A,{}),(0,i.jsxs)("div",{style:{marginBottom:24},children:[(0,i.jsxs)(I,{level:5,children:[(0,i.jsx)(w.A,{style:{marginRight:8}}),"Manual Invitees (",W.length,")"]}),(0,i.jsx)(O.A,{gutter:[16,16],children:W.slice(0,6).map((e,t)=>(0,i.jsx)(P.A,{xs:24,sm:12,md:8,children:(0,i.jsx)(l.A,{size:"small",bordered:!0,style:{borderRadius:6,backgroundColor:"#f0f8ff"},children:(0,i.jsxs)(B.A,{align:"center",gap:12,children:[(0,i.jsx)(H.A,{icon:(0,i.jsx)(_.A,{}),style:{backgroundColor:"#52c41a"}}),(0,i.jsxs)("div",{children:[(0,i.jsx)(L,{strong:!0,style:{display:"block"},children:e.name}),(0,i.jsxs)(B.A,{align:"center",gap:4,children:[(0,i.jsx)(b.A,{style:{fontSize:12,color:"#666"}}),(0,i.jsx)(L,{type:"secondary",children:e.phone_number})]})]})]})})},t))}),W.length>6&&(0,i.jsxs)(L,{type:"secondary",style:{marginTop:8,display:"block"},children:["...and ",W.length-6," more invitees"]})]})]})]}),(0,i.jsx)(N.A,{style:{marginTop:8}}),(0,i.jsxs)(B.A,{justify:"space-between",gap:16,children:[(0,i.jsx)(D.Ay,{loading:es,onClick:()=>Y("draft"),block:!0,icon:(0,i.jsx)(k.A,{}),size:"large",style:{height:45},children:"Save as Draft"}),(0,i.jsx)(D.Ay,{type:"primary",block:!0,icon:(0,i.jsx)(E.A,{}),onClick:()=>Y("active"),loading:es,size:"large",style:{height:45},children:"Send Invitations"})]})]})]})};var q=s(6658),G=s(12115);let Q=e=>{let{templates:t,categories:s}=e,{reset:d,current:h}=(0,r.h)(),[m]=n.A.useForm(),p=[{title:"Select Template",content:(0,i.jsx)(q.A,{templates:t,categories:s})},{title:"Customize",content:(0,i.jsx)(o.A,{})},{title:"Event Details",content:(0,i.jsx)(c.A,{form:m})},{title:"Preview & Send",content:(0,i.jsx)(W,{})}];return(0,G.useEffect)(()=>()=>d(),[]),(0,i.jsxs)(l.A,{children:[(0,i.jsx)(a.A,{current:h,items:p.map(e=>({title:e.title}))}),(0,i.jsx)("div",{style:{margin:"24px 0",minHeight:"300px"},children:p[h].content})]})}},86491:(e,t,s)=>{"use strict";s.d(t,{K3:()=>r,W8:()=>l,lh:()=>n});var i=s(49561);async function r(e){let t=new FormData;Array.from(e.entries()).forEach(e=>{let[s,i]=e;"template"===s&&i instanceof File?t.append("file",i):t.append(s,i)}),Array.from(t.entries()).forEach(e=>{let[t,s]=e;console.log("".concat(t,":"),s)});try{return await i.y1.post("files/upload/",t,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){throw Error("API Error: ".concat(e.message))}}async function n(e){try{return await i.y1.post("events/",e)}catch(e){throw Error(e)}}async function l(e){try{return await i.y1.post("events/",e)}catch(e){throw Error(e)}}},95759:(e,t,s)=>{"use strict";s.d(t,{l:()=>i});let i=(0,s(88693).vt)(e=>({collapsed:!1,setCollapsed:t=>e({collapsed:t}),breakpoint:!0,setBreakpoint:t=>e({breakpoint:t})}))}},e=>{var t=t=>e(e.s=t);e.O(0,[3743,9598,2027,1706,9787,6084,8413,6711,4666,6449,6327,3876,3749,8646,8085,7325,6124,6922,6874,9186,7845,5144,2788,3889,9237,534,3063,998,9584,6002,7110,4616,1506,9602,2660,3702,9733,3741,6463,2802,1406,5928,8441,1684,7358],()=>t(27720)),_N_E=e.O()}]);