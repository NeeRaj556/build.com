(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6022],{58314:(e,t,i)=>{"use strict";i.d(t,{KS:()=>s,qM:()=>r,vR:()=>l});var n=i(49561);async function s(e){let{month:t,year:i}=e;try{return await n.y1.get("events/recived/?skip=0&limit=100&month=".concat(t,"&year=").concat(i))}catch(e){throw Error(e)}}async function l(e){try{return await n.y1.get("events/".concat(e,"/"))}catch(e){throw Error(e)}}async function r(e,t){try{return await n.y1.patch("events/".concat(e,"/"),t)}catch(e){throw Error(e)}}},93210:(e,t,i)=>{Promise.resolve().then(i.bind(i,96915))},96915:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>X});var n=i(95155),s=i(12115),l=i(35695),r=i(26715),a=i(41754),d=i(5041),o=i(94326),c=i(16467),x=i(95108),p=i(77325),m=i(58314),u=i(15825),v=i(884),h=i(6124),_=i(17238),g=i(35125),y=i(81730),j=i(19558),f=i(79659),b=i(79630);let A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2zM304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z"}}]},name:"picture",theme:"outlined"};var w=i(62764),E=s.forwardRef(function(e,t){return s.createElement(w.default,(0,b.A)({},e,{ref:t,icon:A}))}),k=i(52092),B=i(80664);let S=e=>{let{form:t,eventData:i}=e;return(0,n.jsxs)("div",{style:{padding:"16px 0"},children:[(0,n.jsx)("h3",{style:{marginBottom:"24px"},children:"Event Details"}),(0,n.jsx)(B.A,{form:t})]})};var L=i(21121),T=i(6658),C=i(4e4),M=i(11126);let z=e=>{let{eventData:t,templates:i,categories:l}=e,[r,a]=(0,s.useState)("current"),[d,c]=o.Ay.useMessage(),{templateData:x,uploadedImage:m,youtubeLink:v,setTemplateData:_,setUploadedImage:y,setYoutubeLink:j,setMediaType:f,setCurrent:b}=(0,u.h)(),A=[{key:"current",label:"Current Media",children:(0,n.jsx)(h.A,{children:(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsxs)("h4",{children:["Current Media: ",v||t.youtube_url?"YouTube Video":m?"Uploaded Image":x||t.template_url?"Template":"No Media"]}),v||t.youtube_url?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"20px"},children:[(0,n.jsx)(L.A,{style:{fontSize:"48px",color:"#ff4d4f",marginBottom:"16px"}}),(0,n.jsx)("p",{children:"YouTube Video"}),(0,n.jsx)("p",{style:{fontSize:"12px",color:"#666"},children:v||t.youtube_url})]}):m?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"20px"},children:[(0,n.jsx)("img",{src:URL.createObjectURL(m),alt:"Uploaded media",style:{maxWidth:"200px",maxHeight:"200px",objectFit:"contain"}}),(0,n.jsx)("p",{style:{marginTop:"12px"},children:"Uploaded Image"})]}):x?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"20px"},children:[(0,n.jsx)(E,{style:{fontSize:"48px",color:"#1890ff",marginBottom:"16px"}}),(0,n.jsxs)("p",{children:["Template: ",x.title]}),(0,n.jsx)("p",{style:{fontSize:"12px",color:"#666"},children:x.description})]}):t.template_url?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"20px"},children:[(0,n.jsx)("img",{src:t.template_url,alt:"Current template",style:{maxWidth:"200px",maxHeight:"200px",objectFit:"contain"}}),(0,n.jsx)("p",{style:{marginTop:"12px"},children:"Current Template"})]}):(0,n.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:[(0,n.jsx)(E,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,n.jsx)("p",{children:"No media selected for this event"})]}),(0,n.jsx)("div",{style:{marginTop:"24px"},children:(0,n.jsx)(p.Ay,{type:"primary",danger:!0,onClick:()=>{_(void 0),y(void 0),j(null),d.success("Current media cleared. You can now select a new template or upload new media."),a("new")},disabled:!x&&!m&&!v&&!t.template_url&&!t.youtube_url,children:"Change Media"})})]})})},{key:"new",label:"Select New Media",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{marginBottom:"24px"},children:(0,n.jsx)(M.A,{})}),(0,n.jsx)(T.A,{templates:i,categories:l})]})},{key:"customize",label:"Customize Template",children:(0,n.jsx)(C.A,{}),disabled:!x}];return(0,n.jsxs)("div",{style:{padding:"16px 0"},children:[c,(0,n.jsx)("h3",{style:{marginBottom:"24px"},children:"Template & Media"}),(0,n.jsx)(g.A,{activeKey:r,onChange:a,items:A})]})};var F=i(81535),R=i(37974),D=i(98617),I=i(94600),q=i(88077),Y=i(24073),U=i(12088),H=i(50274),K=i(96097);let{Title:N,Text:O,Paragraph:P}=F.A,V=e=>{let{eventData:t}=e,{fullData:i,template:s,uploadedImage:l,youtubeLink:r,imageSize:a,cohosts:d,invitees:o,formData:c}=(0,u.h)(),x=e=>e?new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}):"",p={title:c.title||t.title,description:c.description||t.description,rich_description:c.rich_description||t.rich_description,venue:c.venue||t.venue,event_date:c.event_date||t.event_date,event_date_to:c.event_date_to||t.event_to_date,event_start_time:c.event_start_time||t.event_start_time,event_end_time:c.event_end_time||t.event_end_time,sms:c.sms||t.sms,is_public:void 0!==c.is_public?c.is_public:t.is_public},m=s||l||r||t.template_url||t.youtube_url;return(0,n.jsxs)("div",{style:{padding:"16px 0"},children:[(0,n.jsx)(N,{level:3,style:{marginBottom:"24px"},children:"Event Preview"}),(0,n.jsxs)(h.A,{bordered:!0,style:{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.08)",borderRadius:"8px",overflow:"hidden",maxWidth:"900px",margin:"0 auto"},bodyStyle:{padding:24},children:[(0,n.jsx)(N,{level:2,style:{marginBottom:"16px",color:"#1890ff"},children:p.title}),(0,n.jsx)("div",{style:{marginBottom:"16px"},children:(0,n.jsx)(R.A,{color:p.is_public?"green":"blue",children:p.is_public?"Public Event":"Private Event"})}),m&&(0,n.jsx)("div",{style:{marginBottom:"24px",textAlign:"center"},children:r||t.youtube_url?(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{strong:!0,style:{display:"block",marginBottom:"12px"},children:"Event Video"}),(0,n.jsx)(q.A,{url:r||t.youtube_url||"",width:560,height:315})]}):s?(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{strong:!0,style:{display:"block",marginBottom:"12px"},children:"Event Template"}),(0,n.jsx)(D.A,{src:URL.createObjectURL(s),alt:"Event template",style:{maxWidth:"100%",maxHeight:"400px",objectFit:"contain",border:"1px solid #f0f0f0",borderRadius:"8px"}})]}):l?(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{strong:!0,style:{display:"block",marginBottom:"12px"},children:"Event Image"}),(0,n.jsx)(D.A,{src:URL.createObjectURL(l),alt:"Event image",style:{maxWidth:"100%",maxHeight:"400px",objectFit:"contain",border:"1px solid #f0f0f0",borderRadius:"8px"}})]}):t.template_url?(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{strong:!0,style:{display:"block",marginBottom:"12px"},children:"Event Template"}),(0,n.jsx)(D.A,{src:t.template_url,alt:"Event template",style:{maxWidth:"100%",maxHeight:"400px",objectFit:"contain",border:"1px solid #f0f0f0",borderRadius:"8px"}})]}):null}),(0,n.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,n.jsxs)(_.A,{align:"center",gap:8,style:{marginBottom:"8px"},children:[(0,n.jsx)(Y.A,{style:{color:"#1890ff"}}),(0,n.jsx)(O,{strong:!0,children:"Date & Time:"})]}),(0,n.jsxs)("div",{style:{marginLeft:"24px"},children:[(0,n.jsxs)(O,{children:[x(p.event_date),p.event_start_time&&" at ".concat((e=>e||"")(p.event_start_time))]}),p.event_date_to&&p.event_date_to!==p.event_date&&(0,n.jsxs)(O,{style:{display:"block"},children:["Until: ",x(p.event_date_to),p.event_end_time&&" at ".concat((e=>e||"")(p.event_end_time))]})]})]}),p.venue&&(0,n.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,n.jsxs)(_.A,{align:"center",gap:8,style:{marginBottom:"8px"},children:[(0,n.jsx)(U.A,{style:{color:"#1890ff"}}),(0,n.jsx)(O,{strong:!0,children:"Venue:"})]}),(0,n.jsx)(O,{style:{marginLeft:"24px"},children:p.venue})]}),p.description&&(0,n.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,n.jsx)(O,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Description:"}),p.rich_description?(0,n.jsx)("div",{style:{marginLeft:"8px"},dangerouslySetInnerHTML:{__html:p.rich_description}}):(0,n.jsx)(P,{style:{marginLeft:"8px"},children:p.description})]}),p.sms&&(0,n.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,n.jsx)(O,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"SMS Message:"}),(0,n.jsx)("div",{style:{background:"#f6f6f6",padding:"12px",borderRadius:"6px",marginLeft:"8px"},children:(0,n.jsxs)(O,{italic:!0,children:['"',p.sms,'"']})})]}),(0,n.jsx)(I.A,{}),(0,n.jsxs)(_.A,{justify:"space-between",align:"center",children:[(0,n.jsx)("div",{children:(0,n.jsxs)(_.A,{align:"center",gap:8,children:[(0,n.jsx)(H.A,{style:{color:"#1890ff"}}),(0,n.jsx)(O,{strong:!0,children:"Co-hosts:"}),(0,n.jsx)(O,{children:(null==d?void 0:d.length)||0})]})}),(0,n.jsx)("div",{children:(0,n.jsxs)(_.A,{align:"center",gap:8,children:[(0,n.jsx)(K.A,{style:{color:"#1890ff"}}),(0,n.jsx)(O,{strong:!0,children:"Invitees:"}),(0,n.jsx)(O,{children:(null==o?void 0:o.length)||0})]})})]})]})]})},W=e=>{let{eventData:t,form:i,isLoading:l,onSave:r,onBack:a,templates:d,categories:o}=e,[c,x]=(0,s.useState)("details"),m=[{key:"details",label:(0,n.jsxs)("span",{children:[(0,n.jsx)(f.A,{}),"Edit Details"]}),children:(0,n.jsx)(S,{form:i,eventData:t})},{key:"template",label:(0,n.jsxs)("span",{children:[(0,n.jsx)(E,{}),"Change Template"]}),children:(0,n.jsx)(z,{eventData:t,templates:d,categories:o})},{key:"preview",label:(0,n.jsxs)("span",{children:[(0,n.jsx)(k.A,{}),"Preview"]}),children:(0,n.jsx)(V,{eventData:t})}];return(0,n.jsxs)(h.A,{children:[(0,n.jsxs)(_.A,{justify:"space-between",align:"center",style:{marginBottom:"24px"},children:[(0,n.jsxs)(_.A,{align:"center",gap:16,children:[(0,n.jsx)(p.Ay,{icon:(0,n.jsx)(y.A,{}),onClick:a,type:"text",children:"Back to Events"}),(0,n.jsxs)("h2",{style:{margin:0},children:["Edit Event: ",t.title]})]}),(0,n.jsx)(p.Ay,{type:"primary",icon:(0,n.jsx)(j.A,{}),loading:l,onClick:r,children:"Save Changes"})]}),(0,n.jsx)(g.A,{activeKey:c,onChange:x,items:m,size:"large",style:{minHeight:"500px"}})]})};var G=i(20534),Q=i(30832),J=i.n(Q);let X=()=>{let e=(0,l.useParams)(),t=(0,l.useRouter)(),i=(0,r.jE)(),[h,_]=o.Ay.useMessage(),[g]=G.A.useForm(),[y,j]=(0,s.useState)(!1),f=null==e?void 0:e.id,{setFullData:b,setFormData:A,setTemplateData:w,setImageSize:E,setUploadedImage:k,setTemplate:B,setYoutubeLink:S,setMediaType:L,setCohosts:T,setInvitees:C,setMarkerState:M,setPlaceName:z,updateFormField:F,fullData:R,formData:D,reset:I}=(0,u.h)(),{data:q,isLoading:Y,error:U,isSuccess:H}=(0,a.I)({queryKey:["event",f],queryFn:()=>(0,m.vR)(f),enabled:!!f,staleTime:0,gcTime:0}),{data:K,isLoading:N}=(0,a.I)({queryKey:["templates"],queryFn:v.jx,staleTime:3e5}),{data:O,isLoading:P}=(0,a.I)({queryKey:["categories"],queryFn:v.cp,staleTime:3e5}),V=(0,d.n)({mutationFn:e=>(0,m.qM)(f,e),onSuccess:()=>{h.success("Event updated successfully!"),i.invalidateQueries({queryKey:["event",f]}),i.invalidateQueries({queryKey:["events"]}),t.push("/user/invitations")},onError:e=>{h.error("Failed to update event: ".concat(e.message))}});(0,s.useEffect)(()=>{if(q&&H){let e={title:q.title||"",description:q.description||"",rich_description:q.rich_description||"",sms:q.sms||"",venue:q.venue||"",is_public:q.is_public||!1,category_id:q.category_id||null,host:q.host||"",note:q.note||"",type:q.type||"event",event_date:q.event_date?J()(q.event_date).format("YYYY-MM-DD"):void 0,event_date_to:q.event_to_date?J()(q.event_to_date).format("YYYY-MM-DD"):void 0,event_start_time:q.event_start_time||void 0,event_end_time:q.event_end_time||void 0,csv_ids:q.csv_ids||[],group_ids:q.group_ids||[],name_source:"contact",name_prefix:q.name_prefix||"",name_text:q.name_text||"Guest",name_postfix:q.name_postfix||"",use_contact_names:void 0===q.use_contact_names||q.use_contact_names};if(A(e),q.cohosts&&T(q.cohosts),q.recipient_contacts&&C(q.recipient_contacts),q.location&&(M({lat:q.location.latitude,lng:q.location.longitude}),z(q.location.name)),q.youtube_url&&(S(q.youtube_url),L("youtube")),q.template_id&&K){let e=K.find(e=>e.id===q.template_id);e&&(w(e),E({width:e.width||600,height:e.height||800}))}b(q),g.setFieldsValue(e)}},[q,H,K,g,A,T,C,M,z,S,L,w,E,b]);let Q=async()=>{if(q)try{var e,t,i;j(!0);let n=await g.validateFields(),s={...q,...n,location:{name:D.locName||(null===(e=q.location)||void 0===e?void 0:e.name)||"",latitude:(null===(t=q.location)||void 0===t?void 0:t.latitude)||0,longitude:(null===(i=q.location)||void 0===i?void 0:i.longitude)||0},event_date:n.event_date?J()(n.event_date).toISOString():q.event_date,event_to_date:n.event_date_to?J()(n.event_date_to).toISOString():q.event_to_date,event_from_date:n.event_date?J()(n.event_date).toISOString():q.event_from_date,event_start_time:n.event_start_time||q.event_start_time,event_end_time:n.event_end_time||q.event_end_time,cohosts:q.cohosts||[],recipient_contacts:q.recipient_contacts||[],template_id:q.template_id||null,template_url:q.template_url||"",youtube_url:q.youtube_url||"",template_file_id:q.template_file_id||null,csv_ids:n.csv_ids||[],group_ids:n.group_ids||[],status:q.status||"draft"};V.mutate(s)}catch(e){h.error("Please fill in all required fields")}finally{j(!1)}},X=()=>{t.push("/user/invitations")};return((0,s.useEffect)(()=>()=>{I()},[I]),Y||N||P)?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"100px 0"},children:[(0,n.jsx)(c.A,{size:"large"}),(0,n.jsx)("p",{style:{marginTop:"16px"},children:"Loading event data..."})]}):U?(0,n.jsx)("div",{style:{padding:"24px"},children:(0,n.jsx)(x.A,{message:"Error",description:"Failed to load event: ".concat(U.message),type:"error",showIcon:!0,action:(0,n.jsx)(p.Ay,{size:"small",onClick:X,children:"Go Back"})})}):q?(0,n.jsxs)(n.Fragment,{children:[_,(0,n.jsx)(W,{eventData:q,form:g,isLoading:y||V.isPending,onSave:Q,onBack:X,templates:K||[],categories:O||[]})]}):(0,n.jsx)("div",{style:{padding:"24px"},children:(0,n.jsx)(x.A,{message:"Event Not Found",description:"The requested event could not be found.",type:"warning",showIcon:!0,action:(0,n.jsx)(p.Ay,{size:"small",onClick:X,children:"Go Back"})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[9598,2027,1706,9787,3743,6084,8413,6711,4666,6449,6327,3876,3749,8646,8085,7325,6124,6922,6874,9186,7845,5144,2788,3889,9237,534,3063,998,9584,6002,7110,4616,1506,9602,2660,3702,9733,3741,6463,2802,5928,8441,1684,7358],()=>t(93210)),_N_E=e.O()}]);