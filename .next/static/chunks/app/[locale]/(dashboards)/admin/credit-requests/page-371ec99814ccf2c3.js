(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8447],{33440:(e,t,r)=>{Promise.resolve().then(r.bind(r,35133)),Promise.resolve().then(r.bind(r,87626)),Promise.resolve().then(r.bind(r,67007))},35133:(e,t,r)=>{"use strict";r.d(t,{Card:()=>s.A});var s=r(6124)},49561:(e,t,r)=>{"use strict";r.d(t,{f6:()=>o,y1:()=>c});var s=r(23464),n=r(86774),a=r(98243);let i="https://backend.enimto.com/api/v1/",o=s.A.create({baseURL:i,headers:{"Content-Type":"application/json",accept:"application/json"}});o.interceptors.response.use(e=>e.data,e=>e.response?Promise.reject(e.response.data.detail):Promise.reject(e.message));let c=s.A.create({baseURL:i,headers:{"Content-Type":"application/json",accept:"application/json"}});c.interceptors.request.use(async e=>{let t=await (0,n.g)();return e.headers.Authorization="Bearer ".concat(t.access_token?t.access_token:"no_token"),e},e=>Promise.reject(e)),c.interceptors.response.use(e=>e.data,async e=>{if(!e.response)return Promise.reject(e.message);{let t=e.response.status,r=e.response.data.detail;return(403===t||401===t)&&await (0,a.l)(),Promise.reject(r)}})},52319:(e,t,r)=>{"use strict";r.d(t,{Sd:()=>n,VN:()=>i,fu:()=>o,hJ:()=>a});var s=r(49561);async function n(){try{return await s.y1.get("credit-requests/")}catch(e){throw Error(e)}}async function a(e){try{return await s.y1.put("credit-requests/".concat(e.id),e.details)}catch(e){throw Error(e)}}async function i(e){try{return await s.y1.post("credit-requests/upload/",e,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){throw Error(e)}}async function o(e){try{return await s.y1.post("credit-requests/",e)}catch(e){throw Error(e)}}},67007:(e,t,r)=>{"use strict";r.d(t,{default:()=>b});var s=r(95155),n=r(94326),a=r(6124),i=r(16467),o=r(36768),c=r(31086),l=r(70445),d=r(17238),u=r(28562),p=r(27212),y=r(77325),h=r(95891),j=r(87626),g=r(57164),m=r(12115),f=r(19373),x=r(26715),A=r(5041),w=r(52319),v=r(66766);function S(e){var t;let{data:r}=e,i=(0,x.jE)(),[o,c]=n.Ay.useMessage(),[f,S]=(0,m.useState)(!1),[b,q]=(0,m.useState)(!1),{token:{colorTextTertiary:_}}=l.A.useToken(),k=(0,A.n)({mutationFn:w.hJ,onSuccess:()=>{o.success("Response updated successfully"),i.invalidateQueries({queryKey:["creditRequests"]}),i.invalidateQueries({queryKey:["userData"]})},onError:()=>o.error("Something went wrong"),onSettled:()=>{S(!1),q(!1)}}),C=e=>{k.mutate({details:{status:"approved"},id:e})},R=e=>{k.mutate({details:{status:"rejected"},id:e})};function E(){let e=new Date(r.requested_at);return{date:e.toISOString().slice(0,10),time:e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}}return(0,s.jsxs)(a.A,{style:{margin:"20px 0"},size:"small",hoverable:!0,children:[c,(0,s.jsxs)(d.A,{wrap:"wrap",gap:"small",justify:"space-between",children:[(0,s.jsxs)(d.A,{children:[(0,s.jsx)(u.A,{style:{marginRight:"20px",border:r.user.profile_picture_url?"none":"2px solid black"},size:50,src:(0,s.jsx)(v.default,{src:r.user.profile_picture_url?"".concat(r.user.profile_picture_url):"/user.png",height:50,width:50,alt:"",priority:!0})}),(0,s.jsxs)(d.A,{vertical:!0,children:[(0,s.jsx)(h.A,{type:"secondary",style:{fontSize:"1.25rem"},children:r.user.full_name}),(0,s.jsxs)(h.A,{style:{fontSize:"1rem",color:_},children:["Requested at: ",E().date," ",""," ",E().time]})]})]}),(0,s.jsx)(d.A,{wrap:"wrap",justify:"end",align:"end",vertical:!0,children:(0,s.jsxs)(d.A,{gap:5,children:[(0,s.jsx)(u.A,{src:"/credit-icon.png"}),(0,s.jsx)(j.default,{type:"warning",level:3,children:r.requested_amount})]})})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(d.A,{gap:10,justify:"space-between",wrap:"wrap",children:[(0,s.jsxs)(h.A,{type:"approved"===(t=r.status)?"success":"rejected"===t?"danger":"warning",children:["REQUEST ",r.status.toUpperCase()]}),(0,s.jsx)(g.A,{children:"Click to see full request "}),"pending"===r.status&&(0,s.jsxs)(d.A,{justify:"end",wrap:"wrap",gap:10,children:[(0,s.jsx)(p.A,{title:"Title",description:"Are you sure you want to approve the credit request",open:f,onConfirm:()=>C(r.id),okButtonProps:{loading:k.isPending},onCancel:()=>{S(!1)},children:(0,s.jsx)(y.Ay,{size:"small",type:"primary",onClick:()=>{q(!1),S(e=>!e)},children:"Approve Request"})}),(0,s.jsx)(p.A,{title:"Title",description:"Are you sure you want to reject the credit request",open:b,onConfirm:()=>R(r.id),okButtonProps:{loading:k.isPending},onCancel:()=>q(!1),children:(0,s.jsx)(y.Ay,{size:"small",type:"primary",danger:!0,onClick:()=>{S(!1),q(e=>!e)},children:"Reject Request"})})]})]})]})}let b=function(){let[e,t]=n.Ay.useMessage(),{data:r,isLoading:l,isError:d,isFetching:u,isSuccess:p,error:y}=(0,f.I)({queryKey:["creditRequests"],queryFn:w.Sd,retry:1});return((0,m.useEffect)(()=>{d&&e.error(y.message)},[d]),l)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.A,{variant:"outlined",style:{margin:"20px 0",boxShadow:"none"},size:"small",loading:l}),(0,s.jsx)(a.A,{variant:"outlined",style:{margin:"20px 0",boxShadow:"none"},size:"small",loading:l}),(0,s.jsx)(a.A,{variant:"outlined",style:{margin:"20px 0",boxShadow:"none"},size:"small",loading:l})]}):p?(0,s.jsx)(i.A,{spinning:u,children:0!==r.length?r.map((e,t)=>(0,s.jsx)(S,{data:e},t)):(0,s.jsx)(o.A,{description:"No any credit request found"})}):d?(0,s.jsxs)(s.Fragment,{children:[t,(0,s.jsx)(c.Ay,{status:"error",title:y.message})]}):void 0}},86774:(e,t,r)=>{"use strict";r.d(t,{g:()=>n});var s=r(34477);let n=(0,s.createServerReference)("7f2a6a67a7d279a82b25025e99ca3a830397cdc38b",s.callServer,void 0,s.findSourceMapURL,"getSessionClient")},98243:(e,t,r)=>{"use strict";r.d(t,{l:()=>n});var s=r(34477);let n=(0,s.createServerReference)("7f1a247a9be4835b7241064d2136726da767e5e7e5",s.callServer,void 0,s.findSourceMapURL,"destroySession")}},e=>{var t=t=>e(e.s=t);e.O(0,[4666,86,3876,3749,8646,8085,7325,6124,6922,1086,9186,5144,7845,3889,9237,4714,3063,5201,8745,3558,8441,1684,7358],()=>t(33440)),_N_E=e.O()}]);