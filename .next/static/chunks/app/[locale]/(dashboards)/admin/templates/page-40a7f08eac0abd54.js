(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[226],{10055:(e,t,r)=>{"use strict";r.d(t,{l:()=>n});var a=r(34477);let n=(0,a.createServerReference)("7fef4df98f8100d06e751157b15c80f945dc54bf85",a.callServer,void 0,a.findSourceMapURL,"destroySession")},10746:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});let a="data:image/png;base64,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"},12388:(e,t,r)=>{"use strict";r.d(t,{N_:()=>i,a8:()=>s,rd:()=>c});var a=r(47830),n=r(43089);let o=(0,a.o)({locales:["en","nep"],defaultLocale:"en"}),{Link:i,redirect:A,usePathname:s,useRouter:c,getPathname:l}=(0,n.xp)(o)},19373:(e,t,r)=>{"use strict";r.d(t,{g:()=>n});var a=r(34477);let n=(0,a.createServerReference)("7f7177a3269b8d8c2c9a6ecaeea5051add2a3581c1",a.callServer,void 0,a.findSourceMapURL,"getSessionClient")},37813:(e,t,r)=>{Promise.resolve().then(r.bind(r,95658)),Promise.resolve().then(r.bind(r,62764)),Promise.resolve().then(r.bind(r,87626)),Promise.resolve().then(r.bind(r,45626)),Promise.resolve().then(r.bind(r,48882)),Promise.resolve().then(r.bind(r,64778)),Promise.resolve().then(r.bind(r,89737))},49561:(e,t,r)=>{"use strict";r.d(t,{f6:()=>d,th:()=>g,y1:()=>E});var a=r(23464),n=r(19373),o=r(10055),i=r(74227),A=r(49509);let s=A.env.NEXT_PUBLIC_API_URL,c=s+"/api/v1/",l=s+"/api/v2/",d=a.A.create({baseURL:c,headers:{"Content-Type":"application/json",accept:"application/json"}}),E=a.A.create({baseURL:c,headers:{"Content-Type":"application/json",accept:"application/json"}}),g=a.A.create({baseURL:l,headers:{"Content-Type":"application/json",accept:"application/json"}}),Q=[E,a.A.create({baseURL:l,headers:{"Content-Type":"application/json",accept:"application/json"}})];[d,g].forEach(e=>{e.interceptors.response.use(e=>e.data,e=>e.response?Promise.reject(e.response.data.detail):Promise.reject(e.message))}),Q.forEach(e=>{e.interceptors.request.use(async e=>{let t=await (0,n.g)();return e.headers.Authorization="Bearer ".concat(t.access_token?t.access_token:"no_token"),e},e=>Promise.reject(e))});let u=!1,h=null,y=[],p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;y.forEach(r=>{let{resolve:a,reject:n,config:o}=r;e?n(e):(t&&(o.headers.Authorization="Bearer ".concat(t)),a(o))}),y=[]};Q.forEach(e=>{e.interceptors.response.use(e=>e.data,async t=>{var r,a,i;let A=t.config;if((null===(r=t.response)||void 0===r?void 0:r.status)===401&&!A._retry){if(A._retry=!0,u)return new Promise((e,t)=>{y.push({resolve:e,reject:t,config:A})}).then(t=>e(t));h||(u=!0,h=B());try{if(!await h)return p("Session expired. Please login again."),await (0,o.l)(),Promise.reject("Session expired. Please login again.");{let t=await (0,n.g)();return A.headers.Authorization="Bearer ".concat(t.access_token),p(null,t.access_token),e(A)}}catch(e){return p("Authentication failed. Please login again."),await (0,o.l)(),Promise.reject("Authentication failed. Please login again.")}finally{setTimeout(()=>{h=null,u=!1},100)}}if(!t.response)return Promise.reject(t.message);{let e=t.response.status,r=(null===(a=t.response.data)||void 0===a?void 0:a.detail)||(null===(i=t.response.data)||void 0===i?void 0:i.message)||"An error occurred";return 403===e&&await (0,o.l)(),Promise.reject(r)}})});let B=async()=>{try{let e=await (0,n.g)();if(!(null==e?void 0:e.refresh_token))return await (0,o.l)(),!1;let t=A.env.NEXT_PUBLIC_API_URL;if(!t)throw Error("API URL is not defined");let r=await fetch("".concat(t,"/api/v1/refresh-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e.refresh_token}),cache:"no-store"});if(!r.ok)return await (0,o.l)(),!1;let a=await r.json(),s={...e,access_token:a.access_token,refresh_token:a.refresh_token||e.refresh_token};return await (0,i.N)(s),!0}catch(e){return console.error("Token refresh failed:",e),await (0,o.l)(),!1}}},61860:e=>{e.exports={floatButton:"styles_floatButton__HeivV"}},64778:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var a=r(95155),n=r(70445),o=r(77325);r(12115);var i=r(61860),A=r.n(i);let s=function(e){let{onClick:t,icon:r,children:i,type:s,style:c}=e,{token:{colorBgBase:l}}=n.A.useToken();return(0,a.jsx)("div",{style:{...c,background:l},className:A().floatButton,onClick:t,children:(0,a.jsx)(o.Ay,{block:!0,size:"large",icon:r,type:s,children:i})})}},74227:(e,t,r)=>{"use strict";r.d(t,{N:()=>n});var a=r(34477);let n=(0,a.createServerReference)("7fbd64ebe47753c9152c4e6b30624382d1a35ef8f3",a.callServer,void 0,a.findSourceMapURL,"setSession")},76714:(e,t,r)=>{"use strict";r.d(t,{I7:()=>A,JW:()=>E,LZ:()=>c,Tj:()=>i,mn:()=>n,nt:()=>s,tA:()=>g,ub:()=>o,ul:()=>l,yW:()=>d});var a=r(49561);async function n(e){try{return await a.y1.post("templates/",e)}catch(e){throw Error(e)}}async function o(e,t){try{return await a.y1.put("templates/".concat(t),e)}catch(e){throw Error(e)}}async function i(e){try{return await a.y1.post("templates/upload-template-images/",e,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){throw Error(e)}}async function A(e){try{return await a.y1.delete("templates/".concat(e))}catch(e){throw Error(e)}}async function s(){try{return await a.y1.get("templates/?skip=0&limit=100")}catch(e){throw Error(e)}}async function c(){try{return await a.f6.get("categories/?skip=0&limit=100")}catch(e){throw Error(e)}}async function l(e){try{return await a.y1.delete("categories/".concat(e))}catch(e){throw Error(e)}}async function d(e){try{return await a.y1.post("categories/",e)}catch(e){throw Error(e)}}async function E(e){try{return await a.y1.put("categories/".concat(e.id),e)}catch(e){throw Error(e)}}async function g(e){try{return await a.y1.post("categories/upload-image",e,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){throw Error(e)}}},86917:(e,t,r)=>{"use strict";r.d(t,{A:()=>A});var a=r(95155),n=r(66766),o=r(98617),i=r(10746);let A=e=>{let{src:t,alt:r,preview:A,fallback:s,style:c,className:l,wrapperStyle:d}=e;return(0,a.jsx)(o.A,{preview:A,src:t,alt:r,style:{...c},wrapperStyle:{...d},className:l,fallback:s?i.a:void 0,placeholder:(0,a.jsx)(n.default,{src:t,alt:r,fill:!0,style:{objectFit:"cover"}})})}},89737:(e,t,r)=>{"use strict";r.d(t,{default:()=>m});var a=r(95155),n=r(86917),o=r(94326),i=r(17238),A=r(27212),s=r(77325),c=r(31086),l=r(38105),d=r(56170),E=r(79659),g=r(12115),Q=r(26715),u=r(41754),h=r(5041),y=r(76714),p=r(12388),B=r(6874),f=r.n(B);let m=function(){let e=(0,p.rd)(),[t,r]=o.Ay.useMessage(),[B,m]=(0,g.useState)(null),k=(0,Q.jE)(),{data:C,isLoading:I,isError:v}=(0,u.I)({queryFn:y.nt,queryKey:["userTemplates"]}),j=(0,h.n)({mutationFn:e=>(0,y.I7)(e),onMutate:e=>{m(e)},onSettled:()=>{m(null)},onSuccess:e=>{k.invalidateQueries({queryKey:["userTemplates"]}),t.success("Template of id:".concat(e.id," deleted successfully"))},onError:e=>{t.error(e.message)}}),w=[{title:"Title",dataIndex:"title",key:"title"},{title:"Category",dataIndex:"category_id",key:"category_id"},{title:"ID",dataIndex:"id",key:"id"},{title:"Thumbnail",dataIndex:"thumbnail_url",key:"thumbnail_url",render:(e,t)=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.A,{src:t.thumbnail_url,fallback:!0,alt:"data.id ".concat(t.id),style:{width:"100px",height:"100px",objectFit:"contain"}})})},{dataIndex:"actions",key:"actions",title:"Actions",width:"15%",render:(e,t)=>(0,a.jsxs)(i.A,{gap:8,wrap:"wrap",children:[(0,a.jsx)(A.A,{title:"Delete category",description:(0,a.jsx)(i.A,{vertical:!0,children:"Are you sure to delete this item?"}),onConfirm:()=>j.mutate(t.id),okButtonProps:{loading:B===t.id},okText:"Yes",cancelText:"No",children:(0,a.jsx)(s.Ay,{loading:B===t.id,danger:!0,type:"primary",icon:(0,a.jsx)(d.A,{}),children:"Delete"})}),(0,a.jsx)(f(),{href:"/admin/templates/".concat(t.id),children:(0,a.jsx)(s.Ay,{block:!0,icon:(0,a.jsx)(E.A,{}),children:"Edit"})})]})}];return((0,g.useEffect)(()=>(v&&t.error("Error fetching list"),()=>{}),[]),v)?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(c.Ay,{status:"error",title:"Something went wrong",subTitle:(0,a.jsx)(s.Ay,{type:"link",onClick:()=>e.refresh(),children:"Try again"})})}):(0,a.jsxs)(a.Fragment,{children:[r,(0,a.jsx)(l.A,{loading:I,columns:w,rowKey:"id",dataSource:C})]})}},95658:(e,t,r)=>{"use strict";r.d(t,{Card:()=>a.A,Flex:()=>n.A});var a=r(6124),n=r(17238)}},e=>{var t=t=>e(e.s=t);e.O(0,[2027,4666,6449,6327,3876,3749,8646,8085,7325,6124,6922,6874,1086,9186,7845,5144,3889,9237,4714,3063,998,9584,2343,4616,9602,8105,8745,6468,8441,1684,7358],()=>t(37813)),_N_E=e.O()}]);