(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5495],{6642:(e,t,a)=>{"use strict";a.d(t,{default:()=>y});var r=a(95155),i=a(76714),n=a(26715),s=a(19373),o=a(5041),c=a(94326),l=a(17238),A=a(27212),d=a(77325),g=a(38105),u=a(31086),E=a(56170),m=a(79659),h=a(28509),p=a(86917);let y=function(){let e=(0,n.jE)(),{setIsModalOpen:t,setEdit:a,setEditData:y}=(0,h.d)(),[Q,f]=c.Ay.useMessage(),{data:j,isSuccess:B,isLoading:v,isError:C,error:w}=(0,s.I)({queryKey:["categories"],queryFn:i.LZ}),I=(0,o.n)({mutationFn:i.ul,onSuccess:t=>{e.invalidateQueries({queryKey:["categories"]}),Q.success("Category of id:".concat(t.id," deleted successfully"))},onError:e=>{Q.error(e.message)}}),k=e=>{y({name:e.name,description:e.description,id:e.id,image_url:e.image_url}),a(!0),t(!0)},x=[{dataIndex:"id",key:"id",title:"ID",width:"5%",render:(e,t,a)=>a+1},{dataIndex:"name",key:"name",title:"Name",width:"6%",ellipsis:!0,fixed:!0},{dataIndex:"description",key:"description",title:"Description",ellipsis:!0,width:"20%"},{dataIndex:"image_url",key:"image_url",title:"Image",width:"20%",render:(e,t)=>(0,r.jsx)(p.A,{src:e,alt:t.name+" image",style:{width:"100px",height:"auto"},fallback:!0})},{dataIndex:"created_at",key:"created_at",title:"Create at",ellipsis:!0,width:"10%",render:e=>{var t;return(0,r.jsxs)(r.Fragment,{children:[null==e?void 0:e.split("T")[0]," : ",null==e?void 0:null===(t=e.split("T")[1])||void 0===t?void 0:t.split(".")[0]]})}},{dataIndex:"updated_at",key:"updated_at",ellipsis:!0,title:"Updated at",width:"10%",render:e=>{var t;return(0,r.jsxs)(r.Fragment,{children:[null==e?void 0:e.split("T")[0]," : ",null==e?void 0:null===(t=e.split("T")[1])||void 0===t?void 0:t.split(".")[0]]})}},{dataIndex:"actions",key:"actions",title:"Actions",width:"10%",fixed:"right",render:(e,t)=>(0,r.jsxs)(l.A,{justify:"space-between",gap:8,wrap:"wrap",children:[(0,r.jsx)(A.A,{title:"Delete category",description:(0,r.jsxs)(l.A,{vertical:!0,children:["Are you sure to delete this category?",(0,r.jsx)("div",{children:"If you delete this category then all the templates under this category wil also be deleted."})]}),onConfirm:()=>I.mutate(t.id),okButtonProps:{loading:I.isPending},okText:"Yes",cancelText:"No",children:(0,r.jsx)(d.Ay,{danger:!0,type:"primary",block:!0,icon:(0,r.jsx)(E.A,{}),children:"Delete"})}),(0,r.jsx)(d.Ay,{block:!0,onClick:()=>k(t),icon:(0,r.jsx)(m.A,{}),children:"Edit"})]})}];return v?(0,r.jsx)(g.A,{columns:x,rowKey:"id",loading:!0}):B?(0,r.jsxs)(r.Fragment,{children:[f,(0,r.jsx)(g.A,{dataSource:j,bordered:!0,columns:x,rowKey:"id",scroll:{x:1500}})]}):C?(Q.error(w.message),(0,r.jsxs)(r.Fragment,{children:[f,(0,r.jsx)(u.Ay,{status:"500",subTitle:"Sorry, something went wrong.",extra:(0,r.jsx)(d.Ay,{type:"primary",children:"Back Home"})})]})):void 0}},10746:(e,t,a)=>{"use strict";a.d(t,{a:()=>r});let r="data:image/png;base64,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"},28509:(e,t,a)=>{"use strict";a.d(t,{d:()=>r});let r=(0,a(88693).vt)(e=>({edit:!1,setEdit:t=>e({edit:t}),editData:{name:"",description:"",id:0,image_url:""},setEditData:t=>e({editData:t}),isModalOpen:!1,setIsModalOpen:t=>e({isModalOpen:t})}))},34539:(e,t,a)=>{"use strict";a.d(t,{default:()=>B});var r=a(95155),i=a(94326),n=a(20534),s=a(17238),o=a(77325),c=a(46002),l=a(72070),A=a(98617),d=a(95891),g=a(46996),u=a(83387),E=a(12160),m=a(26715),h=a(5041),p=a(76714),y=a(28509),Q=a(12115),f=a(10746),j=a(87626);let B=function(){let{isModalOpen:e,setIsModalOpen:t,edit:a,setEdit:B,editData:v,setEditData:C}=(0,y.d)(),[w,I]=i.Ay.useMessage(),k=(0,m.jE)(),x=(0,h.n)({mutationFn:p.tA,onError:e=>{w.error(e.message)}}),N=(0,h.n)({mutationFn:p.yW,onSuccess:()=>{w.success("Category created succesfully"),k.invalidateQueries({queryKey:["categories"]}),b()},onError:e=>{w.error(e.message)}}),S=(0,h.n)({mutationFn:p.JW,onSuccess:()=>{w.success("Category updated succesfully"),k.invalidateQueries({queryKey:["categories"]}),b()},onError:e=>{w.error(e.message)}}),b=()=>{C({name:"",description:"",id:0,image_url:""}),B(!1),t(!1),J.resetFields()},[J]=n.A.useForm();return(0,Q.useEffect)(()=>{J.setFieldsValue({name:v.name,description:v.description})},[v,J]),(0,r.jsxs)(r.Fragment,{children:[I,(0,r.jsxs)(s.A,{justify:"space-between",children:[(0,r.jsx)(j.default,{level:3,children:"Template Categories"}),(0,r.jsx)(o.Ay,{onClick:()=>{C({name:"",description:"",id:0,image_url:""}),B(!1),t(!0)},icon:(0,r.jsx)(g.A,{}),type:"primary",children:"Add Categories"})]}),(0,r.jsx)(c.A,{title:a?"Edit Categories":"Add Categories",open:e,onOk:()=>{J.submit()},okText:a?"Update":"Add",destroyOnClose:!0,okButtonProps:{loading:x.isPending||N.isPending},onCancel:b,children:(0,r.jsxs)(n.A,{form:J,onFinish:e=>{if(a){if(e.image){let t=new FormData;t.append("image_in",e.image[0].originFileObj),x.mutate(t,{onSuccess:t=>{let a={name:e.name,description:e.description,image_url:t.icon_url,id:v.id};S.mutate(a)}})}else{let t={name:e.name,description:e.description,id:v.id};S.mutate(t)}}else{let t=new FormData;t.append("image_in",e.image[0].originFileObj),x.mutate(t,{onSuccess:t=>{let a={name:e.name,description:e.description,image_url:t.icon_url};N.mutate(a)}})}},layout:"vertical",children:[(0,r.jsx)(n.A.Item,{rules:[{required:!0,message:"Please enter category name"}],required:!0,name:"name",label:"Name",children:(0,r.jsx)(l.A,{})}),(0,r.jsx)(n.A.Item,{rules:[{required:!0,message:"Please enter category description"}],required:!0,name:"description",label:"Description",children:(0,r.jsx)(l.A.TextArea,{})}),a&&(0,r.jsxs)(s.A,{gap:10,wrap:"wrap",style:{marginBottom:"20px"},children:[(0,r.jsx)(d.A,{children:"Curent image: "}),(0,r.jsx)(A.A,{alt:"category image",src:v.image_url,width:100,fallback:f.a,style:{width:"100px",height:"auto"}})]}),(0,r.jsx)(n.A.Item,{rules:[{required:!a,message:"Please upload category image"}],required:!a,valuePropName:"fileList",name:"image",getValueFromEvent:e=>Array.isArray(e)?e:null==e?void 0:e.fileList,label:a?"Update Image":"Upload Image",children:(0,r.jsxs)(E.A,{customRequest:e=>{let{onSuccess:t}=e;return setTimeout(()=>{t("ok",null)},0)},accept:"image/*",name:"file",maxCount:1,action:void 0,fileList:void 0,children:[(0,r.jsx)("p",{className:"ant-upload-drag-icon",children:(0,r.jsx)(u.A,{})}),(0,r.jsx)("p",{className:"ant-upload-text",children:"Click or drag receipt image to this area to upload"})]})})]})})]})}},49561:(e,t,a)=>{"use strict";a.d(t,{f6:()=>d,th:()=>u,y1:()=>g});var r=a(23464),i=a(66608),n=a(51210),s=a(72508),o=a(49509);let c=o.env.NEXT_PUBLIC_API_URL,l=c+"/api/v1/",A=c+"/api/v2/",d=r.A.create({baseURL:l,headers:{"Content-Type":"application/json",accept:"application/json"}}),g=r.A.create({baseURL:l,headers:{"Content-Type":"application/json",accept:"application/json"}}),u=r.A.create({baseURL:A,headers:{"Content-Type":"application/json",accept:"application/json"}}),E=[g,r.A.create({baseURL:A,headers:{"Content-Type":"application/json",accept:"application/json"}})];[d,u].forEach(e=>{e.interceptors.response.use(e=>e.data,e=>e.response?Promise.reject(e.response.data.detail):Promise.reject(e.message))}),E.forEach(e=>{e.interceptors.request.use(async e=>{let t=await (0,i.g)();return e.headers.Authorization="Bearer ".concat(t.access_token?t.access_token:"no_token"),e},e=>Promise.reject(e))});let m=!1,h=null,p=[],y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;p.forEach(a=>{let{resolve:r,reject:i,config:n}=a;e?i(e):(t&&(n.headers.Authorization="Bearer ".concat(t)),r(n))}),p=[]};E.forEach(e=>{e.interceptors.response.use(e=>e.data,async t=>{var a,r,s;let o=t.config;if((null===(a=t.response)||void 0===a?void 0:a.status)===401&&!o._retry){if(o._retry=!0,m)return new Promise((e,t)=>{p.push({resolve:e,reject:t,config:o})}).then(t=>e(t));h||(m=!0,h=Q());try{if(!await h)return y("Session expired. Please login again."),await (0,n.l)(),Promise.reject("Session expired. Please login again.");{let t=await (0,i.g)();return o.headers.Authorization="Bearer ".concat(t.access_token),y(null,t.access_token),e(o)}}catch(e){return y("Authentication failed. Please login again."),await (0,n.l)(),Promise.reject("Authentication failed. Please login again.")}finally{setTimeout(()=>{h=null,m=!1},100)}}if(!t.response)return Promise.reject(t.message);{let e=t.response.status,a=(null===(r=t.response.data)||void 0===r?void 0:r.detail)||(null===(s=t.response.data)||void 0===s?void 0:s.message)||"An error occurred";return 403===e&&await (0,n.l)(),Promise.reject(a)}})});let Q=async()=>{try{let e=await (0,i.g)();if(!(null==e?void 0:e.refresh_token))return await (0,n.l)(),!1;let t=o.env.NEXT_PUBLIC_API_URL;if(!t)throw Error("API URL is not defined");let a=await fetch("".concat(t,"/api/v1/refresh-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e.refresh_token}),cache:"no-store"});if(!a.ok)return await (0,n.l)(),!1;let r=await a.json(),c={...e,access_token:r.access_token,refresh_token:r.refresh_token||e.refresh_token};return await (0,s.N)(c),!0}catch(e){return console.error("Token refresh failed:",e),await (0,n.l)(),!1}}},51210:(e,t,a)=>{"use strict";a.d(t,{l:()=>i});var r=a(34477);let i=(0,r.createServerReference)("7f94a4f5be4bbe86ff28602338eb3b1e17757bda33",r.callServer,void 0,r.findSourceMapURL,"destroySession")},63606:(e,t,a)=>{Promise.resolve().then(a.bind(a,95658)),Promise.resolve().then(a.bind(a,34539)),Promise.resolve().then(a.bind(a,6642))},66608:(e,t,a)=>{"use strict";a.d(t,{g:()=>i});var r=a(34477);let i=(0,r.createServerReference)("7f6ef96e8b0ebd5011563da96c6f189e5e4212342a",r.callServer,void 0,r.findSourceMapURL,"getSessionClient")},72508:(e,t,a)=>{"use strict";a.d(t,{N:()=>i});var r=a(34477);let i=(0,r.createServerReference)("7f89c1213494ea9ff4952ae407cec9eb241e36637e",r.callServer,void 0,r.findSourceMapURL,"setSession")},76714:(e,t,a)=>{"use strict";a.d(t,{I7:()=>o,JW:()=>g,LZ:()=>l,Tj:()=>s,mn:()=>i,nt:()=>c,tA:()=>u,ub:()=>n,ul:()=>A,yW:()=>d});var r=a(49561);async function i(e){try{return await r.y1.post("templates/",e)}catch(e){throw Error(e)}}async function n(e,t){try{return await r.y1.put("templates/".concat(t),e)}catch(e){throw Error(e)}}async function s(e){try{return await r.y1.post("templates/upload-template-images/",e,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){throw Error(e)}}async function o(e){try{return await r.y1.delete("templates/".concat(e))}catch(e){throw Error(e)}}async function c(){try{return await r.y1.get("templates/?skip=0&limit=100")}catch(e){throw Error(e)}}async function l(){try{return await r.f6.get("categories/?skip=0&limit=100")}catch(e){throw Error(e)}}async function A(e){try{return await r.y1.delete("categories/".concat(e))}catch(e){throw Error(e)}}async function d(e){try{return await r.y1.post("categories/",e)}catch(e){throw Error(e)}}async function g(e){try{return await r.y1.put("categories/".concat(e.id),e)}catch(e){throw Error(e)}}async function u(e){try{return await r.y1.post("categories/upload-image",e,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){throw Error(e)}}},86917:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(95155),i=a(66766),n=a(98617),s=a(10746);let o=e=>{let{src:t,alt:a,preview:o,fallback:c,style:l,className:A,wrapperStyle:d}=e;return(0,r.jsx)(n.A,{preview:o,src:t,alt:a,style:{...l},wrapperStyle:{...d},className:A,fallback:c?s.a:void 0,placeholder:(0,r.jsx)(i.default,{src:t,alt:a,fill:!0,style:{objectFit:"cover"}})})}},95658:(e,t,a)=>{"use strict";a.d(t,{Card:()=>r.A,Flex:()=>i.A});var r=a(6124),i=a(17238)}},e=>{var t=t=>e(e.s=t);e.O(0,[4666,6449,6327,3876,3749,8646,8085,7325,6124,6922,1086,9186,7845,5144,2788,3889,9237,534,4714,3063,998,9584,6002,2070,7110,2343,4616,9602,8105,8745,4841,8441,1684,7358],()=>t(63606)),_N_E=e.O()}]);