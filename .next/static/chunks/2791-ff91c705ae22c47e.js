(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2791],{1228:(e,t,r)=>{"use strict";r.d(t,{DY:()=>o,Sk:()=>l,_h:()=>i,ec:()=>c,iS:()=>s,p7:()=>a});var n=r(49561);async function a(e){try{return await n.f6.post("login/phone-number",e)}catch(e){throw Error(e)}}async function s(e){try{return await n.f6.post("verify-phone-number",e)}catch(e){throw Error(e)}}async function i(e){try{return await n.f6.post("login/access-token",e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(e){throw Error(e)}}async function o(e){try{return await n.f6.post("users/",e)}catch(e){throw Error(e)}}async function l(){try{return await n.y1.get("users/me/")}catch(e){throw Error(e)}}async function c(e){try{return await n.y1.post("change-password",e)}catch(e){throw Error(e)}}},1828:e=>{e.exports={mainContainer:"phone_mainContainer__Vnjz2",formContainer:"phone_formContainer__xy_3U",h2:"phone_h2__yu3pp",errorDiv:"phone_errorDiv__XwZoe"}},12388:(e,t,r)=>{"use strict";r.d(t,{N_:()=>i,a8:()=>l,rd:()=>c});var n=r(47830),a=r(43089);let s=(0,n.o)({locales:["en","nep"],defaultLocale:"en"}),{Link:i,redirect:o,usePathname:l,useRouter:c,getPathname:u}=(0,a.xp)(s)},17238:(e,t,r)=>{"use strict";r.d(t,{A:()=>A});var n=r(12115),a=r(29300),s=r.n(a),i=r(17980),o=r(96249),l=r(15982),c=r(45431),u=r(61388);let p=["wrap","nowrap","wrap-reverse"],d=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],f=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],y=(e,t)=>{let r=!0===t.wrap?"wrap":t.wrap;return{["".concat(e,"-wrap-").concat(r)]:r&&p.includes(r)}},h=(e,t)=>{let r={};return f.forEach(n=>{r["".concat(e,"-align-").concat(n)]=t.align===n}),r["".concat(e,"-align-stretch")]=!t.align&&!!t.vertical,r},m=(e,t)=>{let r={};return d.forEach(n=>{r["".concat(e,"-justify-").concat(n)]=t.justify===n}),r},g=e=>{let{componentCls:t}=e;return{[t]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},v=e=>{let{componentCls:t}=e;return{[t]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},x=e=>{let{componentCls:t}=e,r={};return p.forEach(e=>{r["".concat(t,"-wrap-").concat(e)]={flexWrap:e}}),r},b=e=>{let{componentCls:t}=e,r={};return f.forEach(e=>{r["".concat(t,"-align-").concat(e)]={alignItems:e}}),r},j=e=>{let{componentCls:t}=e,r={};return d.forEach(e=>{r["".concat(t,"-justify-").concat(e)]={justifyContent:e}}),r},w=(0,c.OF)("Flex",e=>{let{paddingXS:t,padding:r,paddingLG:n}=e,a=(0,u.oX)(e,{flexGapSM:t,flexGap:r,flexGapLG:n});return[g(a),v(a),x(a),b(a),j(a)]},()=>({}),{resetStyle:!1});var S=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)0>t.indexOf(n[a])&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};let A=n.forwardRef((e,t)=>{let{prefixCls:r,rootClassName:a,className:c,style:u,flex:p,gap:d,children:f,vertical:g=!1,component:v="div"}=e,x=S(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:b,direction:j,getPrefixCls:A}=n.useContext(l.QO),O=A("flex",r),[_,P,k]=w(O),C=null!=g?g:null==b?void 0:b.vertical,E=s()(c,a,null==b?void 0:b.className,O,P,k,function(e,t){return s()(Object.assign(Object.assign(Object.assign({},y(e,t)),h(e,t)),m(e,t)))}(O,e),{["".concat(O,"-rtl")]:"rtl"===j,["".concat(O,"-gap-").concat(d)]:(0,o.X)(d),["".concat(O,"-vertical")]:C}),N=Object.assign(Object.assign({},null==b?void 0:b.style),u);return p&&(N.flex=p),d&&!(0,o.X)(d)&&(N.gap=d),_(n.createElement(v,Object.assign({ref:t,className:E,style:N},(0,i.A)(x,["justify","wrap","align"])),f))})},28037:(e,t,r)=>{"use strict";r.d(t,{S:()=>a});var n=r(34477);let a=(0,n.createServerReference)("7f8a98137c75415cdb3232c8fd8c8f33f4c7083a79",n.callServer,void 0,n.findSourceMapURL,"redirectTo")},49561:(e,t,r)=>{"use strict";r.d(t,{f6:()=>o,y1:()=>l});var n=r(23464),a=r(86774),s=r(98243);let i="https://backend.enimto.com/api/v1/",o=n.A.create({baseURL:i,headers:{"Content-Type":"application/json",accept:"application/json"}});o.interceptors.response.use(e=>e.data,e=>e.response?Promise.reject(e.response.data.detail):Promise.reject(e.message));let l=n.A.create({baseURL:i,headers:{"Content-Type":"application/json",accept:"application/json"}});l.interceptors.request.use(async e=>{let t=await (0,a.g)();return e.headers.Authorization="Bearer ".concat(t.access_token?t.access_token:"no_token"),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e.data,async e=>{if(!e.response)return Promise.reject(e.message);{let t=e.response.status,r=e.response.data.detail;return(403===t||401===t)&&await (0,s.l)(),Promise.reject(r)}})},62791:(e,t,r)=>{"use strict";r.d(t,{default:()=>q});var n=r(95155),a=r(34477);let s=(0,a.createServerReference)("4052b3b51f0969727eebf406fce03048a68a5c0370",a.callServer,void 0,a.findSourceMapURL,"handlePhoneRegistration");var i=r(65345),o=r(86774),l=r(28037),c=r(1228),u=r(12388),p=r(85359),d=r(5041),f=r(20534),y=r(70445),h=r(17238),m=r(72070),g=r(82343),v=r(97226),x=r(19361),b=r(74947),j=r(77325),w=r(12115),S=function(){return(S=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function A(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)0>t.indexOf(n[a])&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}"function"==typeof SuppressedError&&SuppressedError;var O={exports:{}};!function(){var e={}.hasOwnProperty;function t(){for(var r=[],n=0;n<arguments.length;n++){var a=arguments[n];if(a){var s=typeof a;if("string"===s||"number"===s)r.push(a);else if(Array.isArray(a)){if(a.length){var i=t.apply(null,a);i&&r.push(i)}}else if("object"===s){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){r.push(a.toString());continue}for(var o in a)e.call(a,o)&&a[o]&&r.push(o)}}}return r.join(" ")}O.exports?(t.default=t,O.exports=t):window.classNames=t}();var _=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(O.exports),P={alphabet:/[^A-Za-z]/,"alphabet-numeric":/[\W_]/,"alphabet-symbol":/[\d]|[^\S]/,numeric:/\D/,"numeric-symbol":/[A-Za-z]|[^\S]/,symbol:/[^\W_]|[^\S]/},k=function(e){var t=e.currentTarget;return{nextTarget:t.nextElementSibling,prevTarget:t.previousElementSibling}},C=function(e){var t=null==e?void 0:e.target;return Array.from(null==t?void 0:t.parentNode.children)},E=function(e){var t=null==e?void 0:e.target;return C(e).indexOf(t)},N=function(e){var t=e.inputType,r=e.inputRegex,n=e.value,a="string"==typeof r?new RegExp(r):r,s="custom"===t&&r&&!a.test(n),i="all"!==t&&"custom"!==t&&P[t].test(n);return!!(s||i)},T=function(e,t){e&&"submit"in e?e.submit():null==e||e(t)},R=function(e){e.currentTarget.select()},F=function(e){var t=e.autoSubmit,r=e.fieldLength,n=e.inputRegex,a=e.inputType,s=e.isPreserveFocus,i=e.onChange,o=e.value,l=(0,w.useState)([]),c=l[0],u=l[1],p=(0,w.useCallback)(function(e,t){var r=i?o:c,n=E(e),a=function(e,t,r){if(r||2==arguments.length)for(var n,a=0,s=t.length;a<s;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}([],null!=r?r:[],!0);return a[n]=e.currentTarget.value,(!r||r.join("").length<1)&&u([]),null==t||t(a),i?i(a):u(a),a},[i,c,o]),d=(0,w.useCallback)(function(e){var n=k(e),a=n.nextTarget,i=n.prevTarget,o=e.currentTarget,l=p(e),c=l.join("").length===r,u=e.nativeEvent.inputType,d="insertText"===u,f=d&&!a;return f&&t&&c&&T(t,l),f&&!s?o.blur():d?null==a?void 0:a.select():"deleteContentBackward"===u?null==i?void 0:i.select():void 0},[t,r,p,s]),f=(0,w.useCallback)(function(e){if("Enter"!==(null==e?void 0:e.key)&&!(null==e?void 0:e.metaKey))return N({inputRegex:n,inputType:a,value:null==e?void 0:e.key})?e.preventDefault():void 0},[n,a]);return{handleFocus:R,handleInput:d,handleKeyDown:(0,w.useCallback)(function(e){var t=k(e),r=t.nextTarget,n=t.prevTarget;switch(e.key){case"Backspace":if(e.currentTarget.value)break;case"ArrowLeft":e.preventDefault(),null==n||n.select();break;case"ArrowRight":e.preventDefault(),null==r||r.select()}},[]),handleKeyPress:f,handlePaste:(0,w.useCallback)(function(e){e.preventDefault();var s=E(e),i=C(e),o=e.clipboardData.getData("text");if(!N({inputRegex:n,inputType:a,value:o})){var l=o.split("").slice(0,r-s),c=p(e,function(e){(!e||e.length<1)&&(e=Array(r).fill(""));for(var t=0;t<r;t++)l[t]&&(e[t+s]=l[t]);return e}),u=l.length+s,d=i[u]||i[u-1];d&&(u===s?d.select():d.focus());var f=c.join("").length===r;t&&f&&T(t,c)}},[n,a,r,p,t]),otp:c}};!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===r&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}(".input-otp{display:flex;gap:1em;justify-content:center}.input-otp__field{font-size:20px;font-weight:700;height:64px;max-width:44px;text-align:center;width:100%}");var L=(0,w.memo)((0,w.forwardRef)(function(e,t){var r=e.className,a=A(e,["className"]);return(0,n.jsx)(m.A,S({className:_("input-otp__field",r),ref:t,maxLength:1},a))})),D=(0,w.forwardRef)(function(e,t){var r,a=e.autoFocus,s=void 0!==a&&a,i=e.autoSubmit,o=e.disabled,l=e.id,c=e.inputClassName,u=e.inputRef,p=void 0===u?null:u,d=e.inputRegex,f=e.inputStyle,y=e.inputType,h=e.isPreserveFocus,m=e.length,g=e.placeholder,v=void 0===g?"":g,x=e.onChange,b=e.value,j=e.wrapperClassName,w=e.wrapperStyle,O=A(e,["autoFocus","autoSubmit","disabled","id","inputClassName","inputRef","inputRegex","inputStyle","inputType","isPreserveFocus","length","placeholder","onChange","value","wrapperClassName","wrapperStyle"]),P=(r=void 0===m?6:m)<2?2:r>16?16:r,k=F({autoSubmit:void 0===i?null:i,fieldLength:P,inputRegex:d,inputType:void 0===y?"all":y,isPreserveFocus:void 0!==h&&h,onChange:x,value:b}),C=k.handleFocus,E=k.handleInput,N=k.handleKeyDown,T=k.handleKeyPress,R=k.handlePaste,D=k.otp;return(0,n.jsx)("div",{className:_("input-otp",j),id:l,ref:t,style:w,children:Array(P).fill(null).map(function(e,t){return(0,n.jsx)(L,S({autoFocus:s&&0===t,className:c,disabled:o,onFocus:C,onInput:E,onKeyDown:N,onKeyPress:T,onPaste:R,ref:function(e){p&&(null===p.current&&(p.current=[]),p.current[t]=e)},style:f,value:(null==b?void 0:b[t])||(null==D?void 0:D[t]),placeholder:1===(null==v?void 0:v.length)?v:null==v?void 0:v[t]},O),"input-otp-".concat(t))})})}),I=r(24848),G=r(95891),M=r(95233),K=r(60760),U=r(39545),z=r(1828),B=r.n(z);let X=[{code:"+81",name:"Japan"},{code:"+61",name:"Australia"},{code:"+977",name:"Nepal"}];function q(){let e=(0,u.a8)(),[t,r]=(0,I.A)(),a=(0,u.rd)(),[S,A]=(0,w.useState)({phone_number:""}),[O,_]=(0,w.useState)(),[P]=f.A.useForm(),[k]=f.A.useForm(),[C,E]=(0,w.useState)("+977"),{token:{colorTextSecondary:N}}=y.A.useToken(),T=X.map(e=>({key:e.code,label:(0,n.jsxs)(h.A,{gap:10,justify:"space-between",children:[(0,n.jsx)(G.A,{style:{color:N},children:e.name}),(0,n.jsxs)(G.A,{style:{color:N},children:[" ",e.code]})]})})),R=(0,d.n)({mutationFn:c.p7,onError:e=>{k.setFields([{name:"phone_number",errors:[e.message]}]),t.error(e.message)},onSuccess:async e=>{_(e.user_type),"new"===e.user_type&&await s("".concat(C,"&").concat(S.phone_number))}}),F=(0,d.n)({mutationFn:c.iS,onError:e=>{P.setFields([{name:"otp",errors:[e.message]}])},onSuccess:async e=>{if("registered"===O){var t;await (0,i.N)({...e,isLoggedIn:!0});let r=await (0,o.g)();(0,l.S)(null===(t=r.user)||void 0===t?void 0:t.user_role)}else await (0,i.N)({...e,isLoggedIn:!1}),a.push("/register/user-details")}}),L={hidden:{opacity:0,x:-100,transition:{duration:.5,ease:M.am}},enter:{opacity:1,x:0,transition:{duration:.5,ease:M.am}},exit:{opacity:0,x:100,transition:{duration:.5,ease:M.am}}};return(0,n.jsxs)(n.Fragment,{children:[r,(0,n.jsxs)(K.N,{mode:"wait",initial:!1,children:[!R.isSuccess&&(0,n.jsxs)(U.P.div,{variants:L,initial:"hidden",animate:"enter",exit:"exit",transition:{type:"linear"},children:[(0,n.jsxs)(f.A,{form:k,layout:"vertical",onFinish:e=>{A(e),R.mutate({...e,country_code:C})},size:"large",children:[(0,n.jsx)(f.A.Item,{label:"Enter your mobile number",name:"phone_number",rules:[{required:!0,message:"Please enter your phone number!"},{}],children:(0,n.jsx)(m.A,{onFocus:()=>{R.reset(),k.setFields([{name:"phone_number",errors:[]}])},value:"".concat(S),prefix:(0,n.jsx)(g.A,{menu:{items:T,selectable:!0,defaultSelectedKeys:[C],onSelect:e=>{E(e.key)},style:{color:N}},arrow:!1,children:(0,n.jsx)(G.A,{children:(0,n.jsxs)(v.A,{style:{color:N},children:[C,(0,n.jsx)(p.A,{})]})})})})}),(0,n.jsxs)(x.A,{gutter:[0,10],children:[(0,n.jsx)(b.A,{span:24,children:"/login/phone"===e?(0,n.jsxs)(h.A,{justify:"space-between",gap:20,wrap:"wrap",children:[(0,n.jsx)(j.Ay,{type:"link",style:{padding:"0"},children:(0,n.jsx)(u.N_,{href:"/register",children:"Register New Account"})}),(0,n.jsx)(j.Ay,{type:"link",style:{padding:"0"},children:(0,n.jsx)(u.N_,{href:"/login/username",children:"Login with email"})})]}):(0,n.jsx)(j.Ay,{type:"link",style:{padding:"0"},children:(0,n.jsx)(u.N_,{href:"/login/phone",children:"Already have an account? Sign in"})})}),(0,n.jsx)(b.A,{span:24,children:(0,n.jsx)(j.Ay,{loading:R.isPending,danger:R.isError,htmlType:"submit",block:!0,type:"primary",children:"Submit"})})]})]}),(0,n.jsx)("br",{})]},"phone-form"),R.isSuccess&&(0,n.jsxs)(U.P.div,{variants:L,initial:"hidden",animate:"enter",exit:"exit",transition:{type:"linear"},children:[(0,n.jsx)("br",{}),(0,n.jsx)("h3",{className:B().h2,children:"Enter the otp sent to your device"}),(0,n.jsx)("br",{}),(0,n.jsxs)(f.A,{size:"large",form:P,onFinish:e=>{let t=e.otp.join("");F.mutate({...S,otp:t})},children:[(0,n.jsx)(f.A.Item,{style:{width:"max-content"},name:"otp",rules:[{required:!0,message:"Please enter your OTP!"}],children:(0,n.jsx)(D,{onFocus:F.reset,autoFocus:!0,autoSubmit:P,inputType:"numeric"})}),(0,n.jsxs)(x.A,{gutter:[0,10],children:[(0,n.jsx)(b.A,{span:24,children:(0,n.jsx)(x.A,{justify:"end",children:(0,n.jsx)(j.Ay,{type:"link",style:{padding:"0"},onClick:()=>{F.reset(),R.reset(),P.resetFields(),P.setFields([{name:"otp",errors:void 0}])},children:"Go back"})})}),(0,n.jsx)(b.A,{span:24,children:(0,n.jsx)(j.Ay,{loading:F.isPending,danger:F.isError,htmlType:"submit",type:"primary",block:!0,children:"Submit"})})]})]})]},"otp-form")]})]})}},65345:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});var n=r(34477);let a=(0,n.createServerReference)("7fd6531a42e4cc0916938589ad243c0d598a059d12",n.callServer,void 0,n.findSourceMapURL,"setSession")},86774:(e,t,r)=>{"use strict";r.d(t,{g:()=>a});var n=r(34477);let a=(0,n.createServerReference)("7f2a6a67a7d279a82b25025e99ca3a830397cdc38b",n.callServer,void 0,n.findSourceMapURL,"getSessionClient")},95891:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(12115),a=r(17980),s=r(89237),i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)0>t.indexOf(n[a])&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};let o=n.forwardRef((e,t)=>{var{ellipsis:r}=e,o=i(e,["ellipsis"]);let l=n.useMemo(()=>r&&"object"==typeof r?(0,a.A)(r,["expandable","rows"]):r,[r]);return n.createElement(s.A,Object.assign({ref:t},o,{ellipsis:l,component:"span"}))})},96249:(e,t,r)=>{"use strict";function n(e){return["small","middle","large"].includes(e)}function a(e){return!!e&&"number"==typeof e&&!Number.isNaN(e)}r.d(t,{X:()=>n,m:()=>a})},98243:(e,t,r)=>{"use strict";r.d(t,{l:()=>a});var n=r(34477);let a=(0,n.createServerReference)("7f1a247a9be4835b7241064d2136726da767e5e7e5",n.callServer,void 0,n.findSourceMapURL,"destroySession")}}]);